import"../chunks/DsnmJJEf.js";import{i as Ke}from"../chunks/DgtA8YEt.js";import{w as vs,o as Mt,b as Rs,s as ue,c as Fn}from"../chunks/BOOvQJmq.js";import{F as $s,x as Bn,aX as zs,C as Ot,y as Je,a9 as xt,z as is,g as n,a0 as be,A as Cn,H as Hn,B as Ms,D as Zt,M as vt,aa as qs,ae as In,G as ls,J as Vn,aY as Rt,aZ as $t,I as Gn,a_ as Fs,Q as ie,a$ as Bs,ai as Xs,as as On,K as Us,L as jn,b0 as Ln,b1 as Jt,P as Rn,aH as Ys,b2 as $n,ac as Ks,b3 as zn,ah as qn,b4 as Xn,_ as Ws,t as z,b5 as Un,af as Yn,ad as Kn,ap as Cs,b6 as Wn,p as Ie,m as F,q as w,s as Qn,n as Zn,v as y,l as T,o as Ve,w as x,b7 as Nt,aG as wt,b8 as it,b as I,e as f,b9 as W,k as He,ba as fe,V as H,bb as ps,i as cs,bc as dt,bd as jt}from"../chunks/ftEH15dk.js";import{r as Jn,p as N,s as Ft,a as Et,c as es,i as Z,b as ea,d as ta}from"../chunks/CZOACZ3Q.js";import{a as sa,b as Ue,s as ne,c as Dt,d as pt}from"../chunks/hCBHUXBO.js";function Qs(s,e){return e}function na(s,e,t){for(var o=s.items,r=[],a=e.length,l=0;l<a;l++)zn(e[l].e,r,!0);var b=a>0&&r.length===0&&t!==null;if(b){var m=t.parentNode;qn(m),m.append(t),o.clear(),Xe(s,e[0].prev,e[a-1].next)}Xn(r,()=>{for(var p=0;p<a;p++){var h=e[p];b||(o.delete(h.k),Xe(s,h.prev,h.next)),Ys(h.e,!b)}})}function Me(s,e,t,o,r,a=null){var l=s,b={flags:e,items:new Map,first:null},m=(e&zs)!==0;if(m){var p=s;l=Je?Ot(xt(p)):p.appendChild($s())}Je&&is();var h=null,M=!1,V=new Map,_=be(()=>{var E=t();return On(E)?E:E==null?[]:Xs(E)}),d,g;function i(){aa(g,d,b,V,l,r,e,o,t),a!==null&&(d.length===0?h?Us(h):h=ls(()=>a(l)):h!==null&&jn(h,()=>{h=null}))}Bn(()=>{g??=Ws,d=n(_);var E=d.length;if(M&&E===0)return;M=E===0;let D=!1;if(Je){var O=Cn(l)===Hn;O!==(E===0)&&(l=Ms(),Ot(l),Zt(!1),D=!0)}if(Je){for(var j=null,P,A=0;A<E;A++){if(vt.nodeType===qs&&vt.data===In){l=vt,D=!0,Zt(!1);break}var u=d[A],k=o(u,A);P=fs(vt,b,j,null,u,k,A,r,e,t),b.items.set(k,P),j=P}E>0&&Ot(Ms())}if(Je)E===0&&a&&(h=ls(()=>a(l)));else if(Vn()){var S=new Set,G=Gn;for(A=0;A<E;A+=1){u=d[A],k=o(u,A);var q=b.items.get(k)??V.get(k);q?(e&(Rt|$t))!==0&&Zs(q,u,A,e):(P=fs(null,b,null,null,u,k,A,r,e,t,!0),V.set(k,P)),S.add(k)}for(const[$,B]of b.items)S.has($)||G.skipped_effects.add(B.e);G.add_callback(i)}else i();D&&Zt(!0),n(_)}),Je&&(l=vt)}function aa(s,e,t,o,r,a,l,b,m){var p=(l&$n)!==0,h=(l&(Rt|$t))!==0,M=e.length,V=t.items,_=t.first,d=_,g,i=null,E,D=[],O=[],j,P,A,u;if(p)for(u=0;u<M;u+=1)j=e[u],P=b(j,u),A=V.get(P),A!==void 0&&(A.a?.measure(),(E??=new Set).add(A));for(u=0;u<M;u+=1){if(j=e[u],P=b(j,u),A=V.get(P),A===void 0){var k=o.get(P);if(k!==void 0){o.delete(P),V.set(P,k);var S=i?i.next:d;Xe(t,i,k),Xe(t,k,S),ts(k,S,r),i=k}else{var G=d?d.e.nodes_start:r;i=fs(G,t,i,i===null?t.first:i.next,j,P,u,a,l,m)}V.set(P,i),D=[],O=[],d=i.next;continue}if(h&&Zs(A,j,u,l),(A.e.f&Jt)!==0&&(Us(A.e),p&&(A.a?.unfix(),(E??=new Set).delete(A))),A!==d){if(g!==void 0&&g.has(A)){if(D.length<O.length){var q=O[0],$;i=q.prev;var B=D[0],L=D[D.length-1];for($=0;$<D.length;$+=1)ts(D[$],q,r);for($=0;$<O.length;$+=1)g.delete(O[$]);Xe(t,B.prev,L.next),Xe(t,i,B),Xe(t,L,q),d=q,i=L,u-=1,D=[],O=[]}else g.delete(A),ts(A,d,r),Xe(t,A.prev,A.next),Xe(t,A,i===null?t.first:i.next),Xe(t,i,A),i=A;continue}for(D=[],O=[];d!==null&&d.k!==P;)(d.e.f&Jt)===0&&(g??=new Set).add(d),O.push(d),d=d.next;if(d===null)continue;A=d}D.push(A),i=A,d=A.next}if(d!==null||g!==void 0){for(var R=g===void 0?[]:Xs(g);d!==null;)(d.e.f&Jt)===0&&R.push(d),d=d.next;var Ne=R.length;if(Ne>0){var te=(l&zs)!==0&&M===0?r:null;if(p){for(u=0;u<Ne;u+=1)R[u].a?.measure();for(u=0;u<Ne;u+=1)R[u].a?.fix()}na(t,R,te)}}p&&Rn(()=>{if(E!==void 0)for(A of E)A.a?.apply()}),s.first=t.first&&t.first.e,s.last=i&&i.e;for(var Te of o.values())Ys(Te.e);o.clear()}function Zs(s,e,t,o){(o&Rt)!==0&&Fs(s.v,e),(o&$t)!==0?Fs(s.i,t):s.i=t}function fs(s,e,t,o,r,a,l,b,m,p,h){var M=(m&Rt)!==0,V=(m&Ln)===0,_=M?V?ie(r,!1,!1):Bs(r):r,d=(m&$t)===0?l:Bs(l),g={i:d,v:_,k:a,a:null,e:null,prev:t,next:o};try{if(s===null){var i=document.createDocumentFragment();i.append(s=$s())}return g.e=ls(()=>b(s,_,d,p),Je),g.e.prev=t&&t.e,g.e.next=o&&o.e,t===null?h||(e.first=g):(t.next=g,t.e.next=g.e),o!==null&&(o.prev=g,o.e.prev=g.e),g}finally{}}function ts(s,e,t){for(var o=s.next?s.next.e.nodes_start:t,r=e?e.e.nodes_start:t,a=s.e.nodes_start;a!==null&&a!==o;){var l=Ks(a);r.before(a),a=l}}function Xe(s,e,t){e===null?s.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function mt(s,e,t=!1,o=!1,r=!1){var a=s,l="";z(()=>{var b=Ws;if(l===(l=e()??"")){Je&&is();return}if(b.nodes_start!==null&&(Un(b.nodes_start,b.nodes_end),b.nodes_start=b.nodes_end=null),l!==""){if(Je){vt.data;for(var m=is(),p=m;m!==null&&(m.nodeType!==qs||m.data!=="");)p=m,m=Ks(m);if(m===null)throw Yn(),Kn;Cs(vt,p),a=Ot(m);return}var h=l+"";t?h=`<svg>${h}</svg>`:o&&(h=`<math>${h}</math>`);var M=Wn(h);if((t||o)&&(M=xt(M)),Cs(xt(M),M.lastChild),t||o)for(;xt(M);)a.before(xt(M));else a.before(M)}})}const ra=()=>performance.now(),Ce={tick:s=>requestAnimationFrame(s),now:()=>ra(),tasks:new Set};function Js(){const s=Ce.now();Ce.tasks.forEach(e=>{e.c(s)||(Ce.tasks.delete(e),e.f())}),Ce.tasks.size!==0&&Ce.tick(Js)}function oa(s){let e;return Ce.tasks.size===0&&Ce.tick(Js),{promise:new Promise(t=>{Ce.tasks.add(e={c:s,f:t})}),abort(){Ce.tasks.delete(e)}}}function Hs(s){return function(...e){var t=e[0];return t.preventDefault(),s?.apply(this,e)}}var Q=(s=>(s.A="A",s.B="B",s.C="C",s.D="D",s.E="E",s.F="F",s.G="G",s))(Q||{});const ia=["Cb2","C2","C#2","Db2","D2","D#2","Eb2","A#5","B1","Bb5","B5","B#5","C6"],us=[2,3,4,5],la={C:24,D:26,E:28,F:29,G:31,A:33,B:35};var J=(s=>(s.none="",s.sharp="#",s.flat="b",s))(J||{}),ee=(s=>(s.topNote="topNote",s.bottomNote="bottomNote",s.ding="ding",s))(ee||{}),me=(s=>(s.note="note",s.slap="slap",s.ghost="ghost",s.none="none",s))(me||{});class ds{_id;_htmlElement=null;_note;_alteration;_octave;_isPlaying=!1;_position;_type;get id(){return this._id}get htmlElement(){if(!this._htmlElement)throw new Error("Tried to access HTML element of handpan note, but it is not set.You might want to call refreshHtmlElement() first.");return this._htmlElement}set htmlElement(e){if(!e){console.warn("Tried to set empty html element to handpan note.");return}this._htmlElement=e}get octave(){return this._octave}set octave(e){this._octave=e,this.refresh()}get alteration(){return this._alteration}set alteration(e){this._alteration=e,this.refresh()}get note(){return this._note}set note(e){this._note=e,this.refresh()}get type(){return this._type}get position(){return this._position}get fullName(){return this._note+this._alteration+this._octave}get isPlaying(){return this._isPlaying}get fullDetailedName(){return(this.isDing?" Ding":"")+(this.isBottom?" Bottom":"")+(this.isDing||this.isBottom?" - ":"")+this._position+" - "+this.fullName}get isTop(){return this._type===ee.topNote}get isDing(){return this._type===ee.ding}get isBottom(){return this._type===ee.bottomNote}get midiNumber(){const e=la[this._note]??0;if(!e)throw new Error(`Invalid note: ${this._note}. Cannot calculate MIDI number.`);let t=e+(this._octave-1)*12;return this._alteration===J.sharp?t++:this._alteration===J.flat&&t--,t}constructor(e,t,o,r,a){if(this._note=e,this._alteration=t,this._octave=o,this._type=r,this._position=a,a<0)throw new Error("Note position must be a non-negative and non-zero integer.");this._id=this.fullDetailedName,this.refresh(),this.refreshHtmlElement()}forcePosition(e){this._position=e}setPlaying(){if(!this._htmlElement){console.warn("Playing note is not attached to any HTML element. The issue might be that this not is not in your current handpan tune.");return}this._isPlaying=!0,this._htmlElement.classList.add("playing"),this._htmlElement.firstElementChild?.classList.add("playing")}stopPlaying(){this._htmlElement&&(this._isPlaying=!1,this._htmlElement.classList.remove("playing"),this._htmlElement.firstElementChild?.classList.remove("playing"))}refreshHtmlElement(){if(typeof document>"u")return;const e=document.querySelector(`[data-handpan-note="${this.fullName}"]`);e&&(this.htmlElement=e)}refresh(){this._id=this.fullDetailedName;const e={"B#":[Q.C,J.none,1],"E#":[Q.F,J.none,0],Ab:[Q.G,J.sharp,0],Bb:[Q.A,J.sharp,0],Cb:[Q.B,J.none,-1],Db:[Q.C,J.none,0],Eb:[Q.D,J.sharp,0],Fb:[Q.E,J.none,0],Gb:[Q.F,J.sharp,0]},t=this._note+this._alteration,o=e[t];if(!o)return;let r;[this._note,this._alteration,r]=o,!(r&&(this._octave+r<Math.min(...us)||this._octave+r<Math.max(...us)))&&r&&(this._octave+=r)}}class Lt{_topNotes=[];_dings=[];_bottomNotes=[];constructor(e){e.forEach(t=>this.addNote(t)),this.refresh()}static fromDeserializedJson(e){if(!e)throw"Empty JSON cannot be used to create HandpanTune.";if(!e._topNotes||!e._dings||!e._bottomNotes)throw"Handpan Tune incoming JSON does not contain all necessary fields.";if(!Array.isArray(e._topNotes)||!Array.isArray(e._dings)||!Array.isArray(e._bottomNotes))throw"Handpan Tune incoming JSON does not contain arrays for top notes, dings and/or bottom notes.";return new Lt([...e._topNotes,...e._dings,...e._bottomNotes])}get dings(){return this._dings}get topNotes(){return this._topNotes}get bottomNotes(){return this._bottomNotes}get numberOfNotes(){return this._topNotes.length+this._dings.length+this._bottomNotes.length}get notes(){return[...this._topNotes,...this._dings,...this._bottomNotes]}clone(){return new Lt([...this._topNotes,...this._dings,...this._bottomNotes])}addNote(e){e.isTop?(this._topNotes.push(e),e.forcePosition(this._topNotes.length)):e.isDing?(this._dings.push(e),e.forcePosition(this._dings.length)):e.isBottom&&(this._bottomNotes.push(e),e.forcePosition(this._topNotes.length))}addNoteFromDetails(e,t,o,r){let a;if(r===ee.topNote)a=this._topNotes.length??0;else if(r===ee.ding)a=this._dings.length??0;else if(r===ee.bottomNote)a=this._bottomNotes.length??0;else throw new Error("Invalid note type provided for HandpanNote creation.");const l=new ds(e,t,o,r,a);this.addNote(l)}removeNote(e){e.isTop?(this._topNotes=this._topNotes.filter(t=>t.id!==e.id),e.forcePosition(this._topNotes.length)):e.isDing?(this._dings=this._dings.filter(t=>t.id!==e.id),e.forcePosition(this._dings.length)):e.isBottom&&(this._bottomNotes=this._bottomNotes.filter(t=>t.id!==e.id),e.forcePosition(this._topNotes.length))}addNoteAt(e,t){const o=new ds(Q.A,J.none,3,t,e);let r;switch(t){case ee.topNote:r=this.topNotes;break;case ee.bottomNote:r=this.bottomNotes;break;case ee.ding:r=this.dings;break;default:throw new Error("Expected note to be either top, ding or bottom, and found an unsupported value.")}r.splice(e===1?e-1:e,0,o)}getTopNoteByPosition(e){for(const t of this._topNotes)if(t.position===e)return t;return null}getBottomNoteByPosition(e){for(const t of this._bottomNotes)if(t.position===e)return t;return null}getDingByPosition(e){for(const t of this._dings)if(t.position===e)return t;return null}getSameNote(e){switch(!0){case e.isTop:return this.getTopNoteByPosition(e.position);case e.isDing:return this.getDingByPosition(e.position);case e.isBottom:return this.getBottomNoteByPosition(e.position);default:throw new Error("Expected note to be either top, ding or bottom, and found an unsupported value.")}}refresh(){const e=(t,o)=>{const r=t.position,a=o.position;switch(!0){case r<a:return-1;case r===a:throw new Error("Two notes cannot have the same position!");case r>a:return 1}throw new Error("Uncovered case, maybe note position is NaN?")};this._topNotes.sort(e),this._dings.sort(e),this._bottomNotes.sort(e)}}const ms=vs(_s());function ca(){fa()&&(console.error("No Handpan Tune in storage. Fallback to default tune."),ms.set(_s()))}function fa(){return typeof window<"u"?window?.localStorage:null}function ua(s){ms.set(s.clone())}function _s(){const s=new Lt([]);return s.addNoteFromDetails(Q.C,J.sharp,3,ee.bottomNote),s.addNoteFromDetails(Q.G,J.none,3,ee.ding),s.addNoteFromDetails(Q.A,J.none,3,ee.topNote),s.addNoteFromDetails(Q.B,J.none,3,ee.topNote),s.addNoteFromDetails(Q.C,J.sharp,4,ee.topNote),s.addNoteFromDetails(Q.D,J.sharp,4,ee.topNote),s.addNoteFromDetails(Q.E,J.none,4,ee.topNote),s.addNoteFromDetails(Q.F,J.sharp,4,ee.topNote),s.addNoteFromDetails(Q.G,J.sharp,4,ee.topNote),s}const Ye={...ms,set:ua,init:ca};class xe{url="";buffer=null;static sources=[];static context;constructor(e){xe.context||(xe.context=new AudioContext),this.url=e}load(){return this.url?this.buffer?Promise.resolve(this.buffer):new Promise((e,t)=>{const o=new XMLHttpRequest;o.open("GET",this.url,!0),o.responseType="arraybuffer",o.onload=()=>{xe.context.decodeAudioData(o.response,r=>{if(!r){console.log(`Sound decoding error: ${this.url}`),t(new Error(`Sound decoding error: ${this.url}`));return}this.buffer=r,e(r)})},o.onerror=r=>{console.log("Sound XMLHttpRequest error:",r),t(r)},o.send()}):Promise.reject(new Error(`Missing or invalid URL: ${this.url}`))}play(e=1,t=0,o){if(!this.buffer)return;const r=xe.context.createBufferSource();r.buffer=this.buffer;const a=xe.sources.push(r)-1;r.onended=()=>{console.info("source ended:",r),o&&o(),r.stop(0),xe.sources.splice(a,1)};const l=xe.context.createGain();l.gain.value=e,r.connect(l).connect(xe.context.destination),r.start(t)}stop(){xe.context.close().then(()=>{console.info("Audio context suspended, stopping all sources.")}).catch(e=>{console.error("Error suspending audio context:",e)}),xe.sources.forEach(e=>{e.stop(0)}),xe.sources=[]}}const ss={clac:"clac/clac.flac",gu:"gu/D2.flac",notes:{E2:"shellopan/E2.flac",F2:"shellopan/F2.flac","F#2":"shellopan/Fs2.flac",G2:"shellopan/G2.flac","G#2":"shellopan/Gs2.flac",A2:"shellopan/A2.flac","A#2":"shellopan/As2.flac",B2:"shellopan/B2.flac",C3:"shellopan/C3.flac","C#3":"shellopan/Cs3.flac",D3:"shellopan/D3.flac","D#3":"shellopan/Ds3.flac",E3:"shellopan/E3.flac",F3:"shellopan/F3.flac","F#3":"shellopan/Fs3.flac",G3:"shellopan/G3.flac","G#3":"shellopan/Gs3.flac",A3:"shellopan/A3.flac","A#3":"shellopan/As3.flac",B3:"shellopan/B3.flac",C4:"shellopan/C4.flac","C#4":"shellopan/Cs4.flac",D4:"shellopan/D4.flac","D#4":"shellopan/Ds4.flac",E4:"shellopan/E4.flac",F4:"shellopan/F4.flac","F#4":"shellopan/Fs4.flac",G4:"shellopan/G4.flac","G#4":"shellopan/Gs4.flac",A4:"shellopan/A4.flac","A#4":"shellopan/As4.flac",B4:"shellopan/B4.flac",C5:"shellopan/C5.flac","C#5":"shellopan/Cs5.flac",D5:"shellopan/D5.flac","D#5":"shellopan/Ds5.flac",E5:"shellopan/E5.flac",F5:"shellopan/F5.flac","F#5":"shellopan/Fs5.flac",G5:"shellopan/G5.flac","G#5":"shellopan/Gs5.flac",A5:"shellopan/A5.flac"}};class tt{static _isPlaying=!1;static loadedAudio={};static playingTimeouts=[];static playingNotes=[];static playingAudio=[];static loadAudioFiles(){this.loadAudioFile("clac",ss.clac),this.loadAudioFile("gu",ss.gu),Object.entries(ss.notes).forEach(([e,t])=>{this.loadAudioFile(e,t)})}static playTrack(e,t){this.stop(),this._isPlaying=!0;const o=this.getMsPerBeat(e.bpm,e.beat);let r=o;e.notes.forEach(a=>{this.addPlayingTimeout(()=>tt.playNote(a),r),r+=o}),t&&this.addPlayingTimeout(t,r),this.addPlayingTimeout(()=>this.stop(),r)}static stop(){console.info("STOPPING"),this.playingTimeouts.forEach(e=>{clearTimeout(e)}),this.playingTimeouts=[],this.playingNotes.forEach(e=>{e.stopPlaying()}),this.playingNotes=[],this.playingAudio.forEach(e=>{e.stop()}),this.playingAudio=[],this._isPlaying=!1}static playNote(e){switch(e.setPlaying(),this.playingNotes.push(e),!0){case e.isSlap:this.playNoteByType("clac",1,()=>e.stopPlaying());break;case e.isGhost:this.playNoteByType("clac",1,()=>e.stopPlaying());break;case e.isNone:break;default:this.playNoteByType(e.baseName,1,()=>e.stopPlaying());break}}static playNoteByType(e,t=1,o=null){if(!this.loadedAudio[e]){console.error(`Sound type "${e}" s not loaded or does not exist.`);return}this.loadedAudio[e][0].play(t,1,()=>{o&&o()})}static getMsPerBeat(e,t){return 1e3*60/e/t}static addPlayingTimeout(e,t){this.playingTimeouts.push(setTimeout(e,t))}static loadAudioFile(e,t){const o=new Audio(t);o.src=t,o.preload="auto",o.addEventListener("canplaythrough",()=>{const r=new xe(t);r.load().then(()=>this.loadedAudio[e]=[r,o.duration])})}}var da=F("<button><!></button>");function At(s,e){Ie(e,!0);const t=Jn(e,["$$slots","$$events","$$legacy"]);var o=da();sa(o,()=>({...t}),void 0,void 0,"svelte-9wjlv9");var r=w(o);Qn(r,()=>e.children??Zn),y(o),T(s,o),Ve()}var ha=F('<option class="svelte-jjh050"> </option>'),va=F('<option class="svelte-jjh050"> </option>'),pa=F('<option class="svelte-jjh050"> </option>'),ma=F('<option class="svelte-jjh050">What?</option>'),_a=F('<div class="note-container svelte-jjh050"><div><div class="note-name svelte-jjh050"> </div> <div><div><!> <!></div> <div class="inputs_container svelte-jjh050"><h3>Note</h3> <div class="select_container svelte-jjh050"><select class="svelte-jjh050"></select></div></div> <div class="inputs_container svelte-jjh050"><h3>Octave</h3> <div class="select_container svelte-jjh050"><select class="svelte-jjh050"></select></div></div> <div class="inputs_container svelte-jjh050"><h3>Alteration</h3> <div class="select_container svelte-jjh050"><select class="svelte-jjh050"></select></div></div></div></div></div>');function ns(s,e){Ie(e,!1);const[t,o]=Ft(),r=()=>Et(Ye,"$tuneStore",t);let a=N(e,"note",12),l=N(e,"onChange",8,null);const b=Object.values(Q),m=[1,2,3,4,5],p=Object.values(J);function h(){a().refresh(),l()&&l()(a()),tt.playNoteByType(a().fullName),Ye.set(r().clone())}function M(B){const L=r();L.removeNote(B),Ye.set(L.clone())}Mt(()=>a().refreshHtmlElement()),Rs(()=>a().refreshHtmlElement()),Ke();var V=_a(),_=w(V),d=w(_),g=w(d,!0);y(d);var i=x(d,2);Ue(i,1,"note-menu  svelte-jjh050");var E=w(i),D=w(E);At(D,{onclick:()=>tt.playNoteByType(a().fullName),children:(B,L)=>{Nt();var R=wt("ðŸ”Š");T(B,R)},$$slots:{default:!0}});var O=x(D,2);At(O,{onclick:()=>M(a()),children:(B,L)=>{Nt();var R=wt("ðŸ—‘");T(B,R)},$$slots:{default:!0}}),y(E);var j=x(E,2),P=x(w(j),2),A=w(P);z(()=>{a(),it(()=>{})}),Me(A,5,()=>b,B=>B,(B,L)=>{var R=ha(),Ne=w(R,!0);y(R);var te={};z(()=>{ue(Ne,n(L)),te!==(te=n(L))&&(R.value=(R.__value=n(L))??"")}),T(B,R)}),y(A),y(P),y(j);var u=x(j,2),k=x(w(u),2),S=w(k);z(()=>{a(),it(()=>{})}),Me(S,5,()=>m,B=>B,(B,L)=>{var R=va(),Ne=w(R,!0);y(R);var te={};z(()=>{ue(Ne,n(L)),te!==(te=n(L))&&(R.value=(R.__value=n(L))??"")}),T(B,R)}),y(S),y(k),y(u);var G=x(u,2),q=x(w(G),2),$=w(q);z(()=>{a(),it(()=>{})}),Me($,5,()=>p,B=>B,(B,L)=>{var R=pa(),Ne=w(R,!0);y(R);var te={};z(()=>{ue(Ne,n(L)),te!==(te=n(L))&&(R.value=(R.__value=n(L))??"")}),T(B,R)},B=>{var L=ma();T(B,L)}),y($),y(q),y(G),y(i),y(_),y(V),z(()=>{ne(V,"data-handpan-note",(f(a()),I(()=>a().fullName))),Ue(_,1,`note ${f(a()),I(()=>a().isPlaying?"playing":"")??""}`,"svelte-jjh050"),ue(g,(f(a()),I(()=>a().fullName))),ne(A,"size",I(()=>b.length)),ne(S,"size",I(()=>m.length)),ne($,"size",I(()=>p.length))}),Dt(A,()=>a().note,B=>a(a().note=B,!0)),W("change",A,h),Dt(S,()=>a().octave,B=>a(a().octave=B,!0)),W("change",S,h),Dt($,()=>a().alteration,B=>a(a().alteration=B,!0)),W("change",$,h),T(s,V),Ve(),o()}var ga=F('<div class="handpan-note-container svelte-117otwt"><div class="handpan-note svelte-117otwt">&plus;</div></div>');function bt(s,e){Ie(e,!1);const[t,o]=Ft(),r=()=>Et(Ye,"$tuneStore",t);let a=N(e,"position",8),l=N(e,"type",8),b=r();function m(){b.addNoteAt(a(),l()),Ye.set(b.clone())}Ke();var p=ga(),h=w(p);y(p),W("click",h,m),T(s,p),Ve(),o()}var ba=F("<!> <!>",1),ya=F("<!> <!>",1),Na=F("<!> <!>",1),wa=F('<h2>Tune</h2> <h3>Top notes:</h3> <div class="notes-list"><!> <!></div> <h3>Dings:</h3> <div class="notes-list"><!> <!></div> <h3>Bottom notes:</h3> <div class="notes-list"><!> <!></div>',1);function Ea(s,e){Ie(e,!1);const[t,o]=Ft(),r=()=>Et(Ye,"$tuneStore",t);Ke();var a=wa(),l=x(He(a),4),b=w(l);bt(b,{position:1,get type(){return ee.topNote}});var m=x(b,2);Me(m,3,()=>r().topNotes,g=>g,(g,i,E)=>{var D=ba(),O=He(D);ns(O,{get note(){return r().topNotes[n(E)]},set note(P){r().topNotes[n(E)]=P,it(()=>r()),es(t,"$tuneStore")},$$legacy:!0});var j=x(O,2);{let P=be(()=>n(E)+1);bt(j,{get position(){return n(P)},get type(){return ee.topNote}})}T(g,D)}),y(l);var p=x(l,4),h=w(p);bt(h,{position:1,get type(){return ee.ding}});var M=x(h,2);Me(M,3,()=>r().dings,g=>g,(g,i,E)=>{var D=ya(),O=He(D);ns(O,{get note(){return r().dings[n(E)]},set note(P){r().dings[n(E)]=P,it(()=>r()),es(t,"$tuneStore")},$$legacy:!0});var j=x(O,2);{let P=be(()=>n(E)+1);bt(j,{get position(){return n(P)},get type(){return ee.ding}})}T(g,D)}),y(p);var V=x(p,4),_=w(V);bt(_,{position:1,get type(){return ee.bottomNote}});var d=x(_,2);Me(d,3,()=>r().bottomNotes,g=>g,(g,i,E)=>{var D=Na(),O=He(D);ns(O,{get note(){return r().bottomNotes[n(E)]},set note(P){r().bottomNotes[n(E)]=P,it(()=>r()),es(t,"$tuneStore")},$$legacy:!0});var j=x(O,2);{let P=be(()=>n(E)+1);bt(j,{get position(){return n(P)},get type(){return ee.bottomNote}})}T(g,D)}),y(V),T(s,a),Ve(),o()}class St{_id;type;position;_note;_htmlElement=null;get id(){return this._id}get note(){return this._note}set note(e){if(!e&&this.type===me.note){console.error('Tried to set empty note to TrackNote of type "note". Note is mandatory here.');return}this._note=e,this.refresh()}get htmlElement(){if(!this._htmlElement)throw new Error("Tried to access HTML element of track note, but it is not set.You might want to call refreshHtmlElement() first.");return this._htmlElement}set htmlElement(e){if(!e){console.error("Tried to set empty html element to track note.");return}this._htmlElement=e}get baseName(){switch(!0){case this.isSlap:return"Ã—";case this.isGhost:return"ðŸ‘»";case this.isNone:return"â€”";default:return this._note?.fullName??"-"}}get displayName(){if(!this.isNote)throw new Error(`Note name for the music player can only be retrieved on notes. Current note is "${this.type}".`);if(!this._note)throw new Error(`Tried to get display name of track note, but it has no handpan note associated to it. Type: ${this.type}.`);return this.position.toString()+"-"+this._note.fullName}get isNote(){return this.type===me.note}get isSlap(){return this.type===me.slap}get isGhost(){return this.type===me.ghost}get isNone(){return this.type===me.none}constructor(e,t,o){if(!e&&St.typeNeedsHandpanNote(t))throw`Tried to create track note of type "${t}" with no HandpanNote, but this type needs one.`;this._note=e,this.type=t,this.position=o,this._id=this.position+"-"+this.baseName,this.refresh(),this.refreshHtmlElement()}static createGhost(e){return new St(null,me.ghost,e)}setPlaying(){this.htmlElement.firstElementChild?.classList.add("playing"),this._note&&this._note.setPlaying()}stopPlaying(){this.htmlElement.firstElementChild?.classList.remove("playing"),this._note&&this._note.stopPlaying()}syncWithTuneNote(e){this.refreshHtmlElement(),this._note=e,e.refreshHtmlElement()}refreshHtmlElement(){if(typeof document>"u")return;const e=document.querySelector(`[data-track-note="${this.id}"]`);e&&(this.htmlElement=e)}refresh(){this._id=this.position+"-"+this.baseName}static typeNeedsHandpanNote(e){return e===me.note}}class _e{static MIN_BPM=50;static MAX_BPM=200;static MIN_BEAT=2;static MAX_BEAT=8;_notes;_name;_bpm=120;_beat=4;get name(){return this._name}get notes(){return this._notes}get bpm(){return this._bpm}set bpm(e){e<=0&&(e=1),e>_e.MAX_BPM&&(e=_e.MAX_BPM),this._bpm=e}get beat(){return this._beat}set beat(e){e<_e.MIN_BEAT&&(e=_e.MIN_BEAT),e>_e.MAX_BEAT&&(e=_e.MAX_BEAT),this._beat=e}constructor(e){this._notes=[],this._name=e}addNoteAt(e){const t=St.createGhost(e);this._notes.splice(e===1?e-1:e,0,t)}addNote(e,t){this._notes.push(new St(e,t,this._notes.length))}removeNote(e){this._notes=this._notes.filter(t=>t.id!==e.id)}clone(){const e=new _e(this.name);return e.bpm=this.bpm,e.beat=this.beat,this._notes.forEach(t=>{e.addNote(t.note,t.type)}),e}syncWithTune(e){this._notes.forEach(t=>{if(!t.isNote)return;if(!t.note){console.error(`Track note ${t.baseName} is not linked to a HandpanNote. Skipping sync.`);return}const o=e.getSameNote(t.note);if(!o){console.warn(`Note ${t.baseName} is in the current track but was not found in the handpan tune.`);return}t.syncWithTuneNote(o)})}}const Aa=vs(ka());function Pa(s){return s?[Ta(),en(s)]:[]}function ka(){return en(_s())}function en(s){const e=new _e("Demo");return e.addNote(s.getDingByPosition(1),me.note),e.addNote(s.getTopNoteByPosition(2),me.note),e.addNote(null,me.slap),e.addNote(s.getTopNoteByPosition(4),me.note),e.addNote(s.getDingByPosition(1),me.note),e.addNote(s.getTopNoteByPosition(3),me.note),e.addNote(null,me.slap),e.addNote(s.getTopNoteByPosition(5),me.note),e}function Ta(){let s=1;const e=[],t=new _e("All notes");return t.bpm=180,us.forEach(o=>{[Q.C,Q.D,Q.E,Q.F,Q.G,Q.A,Q.B].forEach(a=>{[J.flat,J.none,J.sharp].forEach(b=>{const m=new ds(a,b,o,ee.topNote,s++);ia.includes(m.fullName)||e.push([m,me.note])})})}),e.forEach(([o,r])=>{t.addNote(o,r)}),t}const et={...Aa,list:Pa};var xa=F('<option class="svelte-3wvbf9"> </option>'),Da=F('<option class="svelte-3wvbf9"> </option>'),Sa=F('<div class="track_inputs_container svelte-3wvbf9"><h3>Note</h3> <div class="track_select_container svelte-3wvbf9"><select class="svelte-3wvbf9"></select></div></div>'),Ma=F('<div class="track-note-container svelte-3wvbf9"><div><div class="note-name svelte-3wvbf9"> </div> <div class="track-note-menu svelte-3wvbf9"><div><!> <!></div> <div class="track_inputs_container svelte-3wvbf9"><h3>Type</h3> <div class="track_select_container svelte-3wvbf9"><select class="svelte-3wvbf9"></select></div></div> <!></div></div></div>');function Fa(s,e){Ie(e,!1);const[t,o]=Ft(),r=()=>Et(et,"$trackStore",t),a=()=>Et(Ye,"$tuneStore",t);let l=N(e,"trackNote",12);const b=Object.values(me);et.subscribe(u=>{u&&l()&&l().refreshHtmlElement()});function m(){l().refresh(),tt.playNote(l())}function p(u){const k=r();k.removeNote(u),et.set(k.clone())}Mt(()=>l().refreshHtmlElement()),Rs(()=>l().refreshHtmlElement()),Ke();var h=Ma(),M=w(h),V=w(M),_=w(V,!0);y(V);var d=x(V,2),g=w(d),i=w(g);At(i,{onclick:()=>tt.playNote(l()),children:(u,k)=>{Nt();var S=wt("ðŸ”Š");T(u,S)},$$slots:{default:!0}});var E=x(i,2);At(E,{onclick:()=>p(l()),children:(u,k)=>{Nt();var S=wt("ðŸ—‘");T(u,S)},$$slots:{default:!0}}),y(g);var D=x(g,2),O=x(w(D),2),j=w(O);z(()=>{l(),it(()=>{})}),Me(j,5,()=>b,u=>u,(u,k)=>{var S=xa(),G=w(S,!0);y(S);var q={};z(()=>{ue(G,n(k)),q!==(q=n(k))&&(S.value=(S.__value=n(k))??"")}),T(u,S)}),y(j),y(O),y(D);var P=x(D,2);{var A=u=>{var k=Sa(),S=x(w(k),2),G=w(S);z(()=>{l(),it(()=>{a()})}),Me(G,5,()=>(a(),I(()=>a().notes)),q=>q.id,(q,$)=>{var B=Da(),L=w(B,!0);y(B);var R={};z(()=>{ue(L,(n($),I(()=>n($).fullDetailedName))),R!==(R=n($))&&(B.value=(B.__value=n($))??"")}),T(q,B)}),y(G),y(S),y(k),z(()=>ne(G,"size",(a(),I(()=>a().numberOfNotes)))),Dt(G,()=>l().note,q=>l(l().note=q,!0)),W("change",G,m),T(u,k)};Z(P,u=>{f(l()),a(),I(()=>l()&&a()&&l().isNote)&&u(A)})}y(d),y(M),y(h),z(()=>{ne(h,"data-track-note",(f(l()),I(()=>l().id))),Ue(M,1,`track-note type-${f(l()),I(()=>l().type)??""}`,"svelte-3wvbf9"),ue(_,(f(l()),I(()=>l().baseName))),ne(j,"size",I(()=>b.length))}),Dt(j,()=>l().type,u=>l(l().type=u,!0)),T(s,h),Ve(),o()}var Ba=F('<div class="track-note-container svelte-g8snzt"><div class="track-note svelte-g8snzt">&plus;</div></div>');function Is(s,e){Ie(e,!1);let t=N(e,"position",8),o;et.subscribe(b=>o=b||o);function r(){o.addNoteAt(t()),et.set(o)}Ke();var a=Ba(),l=w(a);y(a),W("click",l,r),T(s,a),Ve()}function Vs(s){return Object.prototype.toString.call(s)==="[object Date]"}function hs(s,e,t,o){if(typeof t=="number"||Vs(t)){const r=o-t,a=(t-e)/(s.dt||1/60),l=s.opts.stiffness*r,b=s.opts.damping*a,m=(l-b)*s.inv_mass,p=(a+m)*s.dt;return Math.abs(p)<s.opts.precision&&Math.abs(r)<s.opts.precision?o:(s.settled=!1,Vs(t)?new Date(t.getTime()+p):t+p)}else{if(Array.isArray(t))return t.map((r,a)=>hs(s,e[a],t[a],o[a]));if(typeof t=="object"){const r={};for(const a in t)r[a]=hs(s,e[a],t[a],o[a]);return r}else throw new Error(`Cannot spring ${typeof t} values`)}}function Ca(s,e={}){const t=vs(s),{stiffness:o=.15,damping:r=.8,precision:a=.01}=e;let l,b,m,p=s,h=s,M=1,V=0,_=!1;function d(i,E={}){h=i;const D=m={};return s==null||E.hard||g.stiffness>=1&&g.damping>=1?(_=!0,l=Ce.now(),p=i,t.set(s=h),Promise.resolve()):(E.soft&&(V=1/((E.soft===!0?.5:+E.soft)*60),M=0),b||(l=Ce.now(),_=!1,b=oa(O=>{if(_)return _=!1,b=null,!1;M=Math.min(M+V,1);const j=Math.min(O-l,1e3/30),P={inv_mass:M,opts:g,settled:!0,dt:j*60/1e3},A=hs(P,p,s,h);return l=O,p=s,t.set(s=A),P.settled&&(b=null),!P.settled})),new Promise(O=>{b.promise.then(()=>{D===m&&O()})}))}const g={set:d,update:(i,E)=>d(i(h,s),E),subscribe:t.subscribe,stiffness:o,damping:r,precision:a};return g}function ht(s){return typeof s=="number"&&!isNaN(s)&&isFinite(s)}const ye=(s,e=2)=>parseFloat((+s).toFixed(e)),Gs=function(s,e,t){return s<=e?e:s>=t?t:s},we=function(s,e,t,o=2){let r=(s-e)/(t-e)*100;return isNaN(r)||r<=0?0:r>=100?100:ye(r,o)},Ha=function(s,e,t){return(t-e)/100*s+e},Ze=function(s,e,t,o,r=2,a=null){if(s=ht(s)?s:a?.[0]??e,s<=(a?.[0]??e)||s>=(a?.[1]??t))return s=Gs(s,a?.[0]??e,a?.[1]??t);let l=(s-e)%o,b=s-l;return Math.abs(l)*2>=o?b+=l>0?o:-o:s>=t-l&&(b=t),b=Gs(b,a?.[0]??e,a?.[1]??t),ye(b,r)},Ia=(s="")=>`${s}`.replace(/<[^>]*>/g,""),yt=s=>{const{clientX:e,clientY:t}="touches"in s?s.touches[0]||s.changedTouches[0]:s;return{x:e,y:t}},Os=s=>{if(!s)return-1;for(var e=0;s=s.previousElementSibling;)e++;return e},as=(s,e,t)=>{if(t==="min")return e[0]>s;if(t==="max")return e[0]<s;if(t)return e[0]<s&&e[1]>s},rs=(s,e)=>e?s<e[0]||s>e[1]:!1,os=(s,e,t=2)=>e.some(o=>ye(o,t)===ye(s,t)),js=(s,e,t,o,r,a=2)=>ye(e+s*r*o,a),Gt=(s,e,t,o,r,a)=>{const l=s.getBoundingClientRect();let b=0,m=0,p=0;return t?(b=e.y-l.top,m=b/l.height*100,m=o?m:100-m):(b=e.x-l.left,m=b/l.width*100,m=o?100-m:m),p=Ha(m,r,a),{pointerVal:p,pointerPercent:m}};var Va=F('<span class="rsPipValPrefix"> </span>'),Ga=F('<span class="rsPipValSuffix"> </span>'),Oa=F('<span class="rsPipVal"><!> <!> <!></span>'),ja=F("<span><!></span>"),La=F('<span class="rsPipValPrefix"> </span>'),Ra=F('<span class="rsPipValSuffix"> </span>'),$a=F('<span class="rsPipVal"><!> <!> <!></span>'),za=F("<span><!></span>"),qa=F('<span class="rsPipValPrefix"> </span>'),Xa=F('<span class="rsPipValSuffix"> </span>'),Ua=F('<span class="rsPipVal"><!> <!> <!></span>'),Ya=F("<span><!></span>"),Ka=F("<div><!> <!> <!></div>");function Wa(s,e){Ie(e,!1);const t=ie(),o=ie();let r=N(e,"range",8,!1),a=N(e,"min",8,0),l=N(e,"max",8,100),b=N(e,"step",8,1),m=N(e,"value",24,()=>(l()+a())/2),p=N(e,"values",24,()=>[m()]),h=N(e,"vertical",8,!1),M=N(e,"reversed",8,!1),V=N(e,"hoverable",8,!0),_=N(e,"disabled",8,!1),d=N(e,"limits",8,null),g=N(e,"pipstep",24,()=>{}),i=N(e,"all",8,!0),E=N(e,"first",24,()=>{}),D=N(e,"last",24,()=>{}),O=N(e,"rest",24,()=>{}),j=N(e,"prefix",8,""),P=N(e,"suffix",8,""),A=N(e,"formatter",8,(re,X,ge)=>re),u=N(e,"precision",8,2),k=N(e,"focus",8),S=N(e,"orientationStart",8),G=N(e,"moveHandle",8),q=null,$=ie(0);const B=500;let L=ie(1);function R(re){q=yt(re)}function Ne(re,X){const ge=yt(X);!_()&&q&&(Math.sqrt(Math.pow(q.x-ge.x,2)+Math.pow(q.y-ge.y,2))<=5&&G()(null,re),q=null)}fe(()=>f(h()),()=>{H(t,h()?50:100)}),fe(()=>(f(l()),f(a()),f(b()),n(t)),()=>{H(o,(l()-a())/b()>=n(t))}),fe(()=>(n(L),f(g()),n(o),f(l()),f(a()),n(t),n($),f(b())),()=>{if(H(L,g()??(n(o)?(l()-a())/(n(t)/5):1)),H($,Math.ceil((l()-a())/(b()*n(L)))),n($)>B)for(console.warn('RangePips: You are trying to render too many pips. This will cause performance issues. Try increasing the "pipstep" prop to reduce the number of pips shown.');n($)>=B;)H(L,n(L)+n(L)),H($,Math.ceil((l()-a())/(b()*n(L))))}),ps(),Ke();var te=Ka();let Te;var Fe=w(te);{var Ge=re=>{var X=ja();let ge;ne(X,"data-index",0);var nt=w(X);{var at=U=>{var Y=Oa(),de=w(Y);{var Ee=ae=>{var oe=Va(),K=w(oe,!0);y(oe),z(()=>ue(K,j())),T(ae,oe)};Z(de,ae=>{j()&&ae(Ee)})}var Ae=x(de,2);mt(Ae,()=>(f(A()),f(ye),f(a()),f(u()),I(()=>A()(ye(a(),u()),0,0))));var he=x(Ae,2);{var le=ae=>{var oe=Ga(),K=w(oe,!0);y(oe),z(()=>ue(K,P())),T(ae,oe)};Z(he,ae=>{P()&&ae(le)})}y(Y),T(U,Y)};Z(nt,U=>{(i()==="label"||E()==="label")&&U(at)})}y(X),z((U,Y)=>{ge=Ue(X,1,"rsPip rsPip--first",null,ge,U),pt(X,`${S()??""}: 0%;`),ne(X,"data-val",Y)},[()=>({rsSelected:os(a(),p(),u()),rsInRange:as(a(),p(),r()),rsOutOfLimit:rs(a(),d())}),()=>(f(ye),f(a()),f(u()),I(()=>ye(a(),u())))]),W("pointerdown",X,U=>{R(U)}),W("pointerup",X,U=>{Ne(a(),U)}),T(re,X)};Z(Fe,re=>{(i()&&E()!==!1||E())&&re(Ge)})}var Oe=x(Fe,2);{var st=re=>{var X=cs(),ge=He(X);Me(ge,1,()=>(n($),I(()=>Array(n($)))),Qs,(nt,at,U)=>{const Y=be(()=>(f(js),f(a()),f(l()),n(L),f(b()),f(u()),I(()=>js(U,a(),l(),n(L),b(),u()))));var de=cs(),Ee=He(de);{var Ae=he=>{var le=za();let ae;ne(le,"data-index",U);var oe=w(le);{var K=ve=>{var De=$a(),Pt=w(De);{var je=Le=>{var Re=La(),_t=w(Re,!0);y(Re),z(()=>ue(_t,j())),T(Le,Re)};Z(Pt,Le=>{Le(je)})}var Bt=x(Pt,2);mt(Bt,()=>(f(A()),f(n(Y)),f(we),f(a()),f(l()),f(u()),I(()=>A()(n(Y),U,we(n(Y),a(),l(),u())))));var Xt=x(Bt,2);{var kt=Le=>{var Re=Ra(),_t=w(Re,!0);y(Re),z(()=>ue(_t,P())),T(Le,Re)};Z(Xt,Le=>{Le(kt)})}y(De),T(ve,De)};Z(oe,ve=>{(i()==="label"||O()==="label")&&ve(K)})}y(le),z((ve,De)=>{ae=Ue(le,1,"rsPip",null,ae,ve),pt(le,`${S()??""}: ${De??""}%;`),ne(le,"data-val",n(Y))},[()=>({rsSelected:os(n(Y),p(),u()),rsInRange:as(n(Y),p(),r()),rsOutOfLimit:rs(n(Y),d())}),()=>(f(we),f(n(Y)),f(a()),f(l()),f(u()),I(()=>we(n(Y),a(),l(),u())))]),W("pointerdown",le,ve=>{R(ve)}),W("pointerup",le,ve=>{Ne(n(Y),ve)}),T(he,le)};Z(Ee,he=>{n(Y)>a()&&n(Y)<l()&&he(Ae)})}T(nt,de)}),T(re,X)};Z(Oe,re=>{(i()&&O()!==!1||O())&&re(st)})}var zt=x(Oe,2);{var qt=re=>{var X=Ya();let ge;var nt=w(X);{var at=U=>{var Y=Ua(),de=w(Y);{var Ee=ae=>{var oe=qa(),K=w(oe,!0);y(oe),z(()=>ue(K,j())),T(ae,oe)};Z(de,ae=>{j()&&ae(Ee)})}var Ae=x(de,2);mt(Ae,()=>(f(A()),f(ye),f(l()),f(u()),n($),I(()=>A()(ye(l(),u()),n($),100))));var he=x(Ae,2);{var le=ae=>{var oe=Xa(),K=w(oe,!0);y(oe),z(()=>ue(K,P())),T(ae,oe)};Z(he,ae=>{P()&&ae(le)})}y(Y),T(U,Y)};Z(nt,U=>{(i()==="label"||D()==="label")&&U(at)})}y(X),z((U,Y)=>{ge=Ue(X,1,"rsPip rsPip--last",null,ge,U),pt(X,`${S()??""}: 100%;`),ne(X,"data-val",Y),ne(X,"data-index",n($))},[()=>({rsSelected:os(l(),p(),u()),rsInRange:as(l(),p(),r()),rsOutOfLimit:rs(l(),d())}),()=>(f(ye),f(l()),f(u()),I(()=>ye(l(),u())))]),W("pointerdown",X,U=>{R(U)}),W("pointerup",X,U=>{Ne(l(),U)}),T(re,X)};Z(zt,re=>{(i()&&D()!==!1||D())&&re(qt)})}y(te),z(re=>Te=Ue(te,1,"rangePips",null,Te,re),[()=>({rsDisabled:_(),rsHoverable:V(),rsVertical:h(),rsReversed:M(),rsFocus:k()})]),T(s,te),Ve()}var Qa=F('<span class="rangeFloatPrefix"> </span>'),Za=F('<span class="rangeFloatSuffix"> </span>'),Ja=F('<span class="rangeFloat"><!><!><!></span>'),er=F('<span role="slider"><span class="rangeNub"></span> <!></span>'),tr=F('<span class="rangeLimit"></span>'),sr=F('<span class="rangeFloatPrefix"> </span>'),nr=F('<span class="rangeFloatSuffix"> </span>'),ar=F('<span class="rangeFloatPrefix"> </span>'),rr=F('<span class="rangeFloatSuffix"> </span>'),or=F("<!><!><!> <!><!><!>",1),ir=F('<span class="rangeFloat"><!></span>'),lr=F("<span><!></span>"),cr=F('<div role="none"><!> <!> <!> <!></div>');function Ls(s,e){Ie(e,!1);const[t,o]=Ft(),r=()=>Et(n(je),"$springPositions",t),a=ie(),l=ie(),b=ie();let m=N(e,"slider",28,()=>{}),p=N(e,"precision",8,2),h=N(e,"range",8,!1),M=N(e,"pushy",8,!1),V=N(e,"draggy",8,!1),_=N(e,"min",12,0),d=N(e,"max",12,100),g=N(e,"step",12,1),i=N(e,"values",28,()=>[ye((d()+_())/2,p())]),E=N(e,"value",28,()=>i()[0]),D=N(e,"vertical",8,!1),O=N(e,"float",8,!1),j=N(e,"rangeFloat",8,!1),P=N(e,"reversed",8,!1),A=N(e,"hoverable",8,!0),u=N(e,"disabled",8,!1),k=N(e,"limits",8,null),S=N(e,"rangeGapMin",12,0),G=N(e,"rangeGapMax",12,1/0),q=N(e,"pips",8,!1),$=N(e,"pipstep",24,()=>{}),B=N(e,"all",8,!0),L=N(e,"first",24,()=>{}),R=N(e,"last",24,()=>{}),Ne=N(e,"rest",24,()=>{}),te=N(e,"prefix",8,""),Te=N(e,"suffix",8,""),Fe=N(e,"formatter",12,(c,v,C)=>c),Ge=N(e,"handleFormatter",28,Fe),Oe=N(e,"rangeFormatter",12,null),st=N(e,"ariaLabels",28,()=>[]),zt=N(e,"id",24,()=>{}),qt=N(e,"class",8,""),re=N(e,"style",24,()=>{}),X=N(e,"darkmode",8,!1),ge=N(e,"springValues",24,()=>({stiffness:.15,damping:.4})),nt=N(e,"spring",8,!0);const at=Fn();let U=ie(!1),Y=ie(0),de=ie(!1),Ee=!1,Ae=ie(!1),he=!1,le=ie(!1),ae=[1,1],oe=!1,K=ie(-1),ve=[],De=[],Pt=ie(0),je=ie();const Bt=()=>{Re(),i()[0]!==E()&&i(i()[0]=E(),!0)},Xt=()=>{Le(),E()!==i()[0]&&E(i()[0])},kt=()=>{ht(_())||(_(0),console.error("'min' prop must be a valid finite Number")),ht(d())||(d(100),console.error("'max' prop must be a valid finite Number")),_()>=d()&&(_(0),d(100),console.error("'min' prop should be less than 'max'")),_(ye(_(),p())),d(ye(d(),p()))},Le=()=>{ht(E())||(E((d()+_())/2),console.error("'value' prop should be a Number"))},Re=()=>{Array.isArray(i())?i().some(c=>!ht(c))&&(i(i().map(c=>ht(c)?c:(d()+_())/2)),console.error("'values' prop should be an Array of Numbers")):(i([E()]),console.error("'values' prop should be an Array"))},_t=()=>{(!ht(g())||g()<=0)&&(g(1),console.error("'step' prop must be a positive Number"))},tn=()=>{i().length>1&&!Array.isArray(st())&&(st([]),console.warn("'ariaLabels' prop should be an Array"))},Ut=()=>{if(i(i().map(c=>Ze(c,_(),d(),g(),p(),k()))),S()<0&&S(0),G()<0&&G(1/0),S()>G()&&S(G()),G()<1/0){const c=Ze(i()[0]+G(),_(),d(),g(),p(),k());i()[1]>c&&i(i()[1]=c,!0)}if(S()>0){const c=Ze(i()[0]+S(),_(),d(),g(),p(),k());i()[1]<c&&i(i()[1]=c,!0)}},Ct=()=>{(Fe()===null||Fe()===void 0)&&(console.error("formatter must be a function"),Fe((c,v,C)=>c)),(Ge()===null||Ge()===void 0)&&(console.error("handleFormatter must be a function"),Ge(Fe())),Oe()===void 0&&(console.error("rangeFormatter must be a function, or null"),Oe(null))};kt(),Le(),Re(),_t(),Ut(),Ct();const sn=c=>{ta(H(je,Ca(c.map(v=>we(v,_(),d())),ge())),"$springPositions",t)},nn=c=>{requestAnimationFrame(()=>{n(je).set(c.map(v=>we(v,_(),d())),{hard:!nt()})})},an=()=>{n(je)&&(jt(je,n(je).stiffness=ge().stiffness??.15),jt(je,n(je).damping=ge().damping??.4))};function rn(c){return requestAnimationFrame(()=>{if(c){const v=c.getBoundingClientRect();H(Pt,D()?v.height:v.width)}})}let Yt,Tt;Mt(()=>(m()&&(Yt=new ResizeObserver(c=>{Tt&&cancelAnimationFrame(Tt),Tt=rn(c[0].target)}),Yt.observe(m()),setTimeout(()=>{H(U,!0)},16)),()=>{Tt&&cancelAnimationFrame(Tt),Yt?.disconnect?.(),H(U,!1)}));function on(c){if(!m())return!1;const v=m().querySelectorAll(".handle"),C=Array.prototype.includes.call(v,c),se=Array.prototype.some.call(v,pe=>pe.contains(c));return C||se}function ln(c,v){return v==="min"||v==="max"?c.slice(0,1):v?c.slice(0,2):c}function cn(c){if(!m())return 0;const{pointerVal:v}=Gt(m(),c,D(),P(),_(),d());let C=0;return h()===!0&&i()[0]===i()[1]?v>i()[1]?C=1:C=0:C=i().indexOf([...i()].sort((se,pe)=>Math.abs(v-se)-Math.abs(v-pe))[0]),C}function Kt(c){if(!m()||!Ee)return;const{pointerVal:v}=Gt(m(),c,D(),P(),_(),d());rt(n(K),v)}function fn(c){if(!m()||!V()||!he||h()==="min"||h()==="max")return;const{pointerVal:v}=Gt(m(),c,D(),P(),_(),d());ae=[i()[0]-v,i()[1]-v]}function un(c){if(!m()||!V()||!he||h()==="min"||h()==="max")return;const{pointerVal:v}=Gt(m(),c,D(),P(),_(),d());H(K,-1),rt(0,v+ae[0],!1),rt(1,v+ae[1],!0)}function rt(c,v,C=!0){return v=Ze(v,_(),d(),g(),p(),k()),c===null&&(c=n(K)),h()===!0&&(c===0?v>i()[1]-S()?M()&&v<=(k()?.[1]??d())-S()?i(i()[1]=v+S(),!0):v=i()[1]-S():v<i()[1]-G()&&(M()?i(i()[1]=v+G(),!0):v=i()[1]-G()):c===1&&(v<i()[0]+S()?M()&&v>=(k()?.[0]??_())+S()?i(i()[0]=v-S(),!0):v=i()[0]+S():v>i()[0]+G()&&(M()?i(i()[0]=v-G(),!0):v=i()[0]+G()))),i()[c]!==v&&i(i()[c]=Ze(v,_(),d(),g(),p(),k()),!0),C&&dn(i()),v}function dn(c){De.some((C,se)=>C!==c[se])&&(wn(),De=[...c])}function hn(c){return h()==="min"?0:c[0]}function vn(c){return h()==="max"?100:h()==="min"?c[0]:c[1]}function pn(c){c.target,oe&&(H(de,!1),Ee=!1,H(Ae,!1),he=!1,H(le,!1))}function mn(c){const v=c.target;u()||(H(K,Os(v)),H(de,!0))}function _n(c){if(!u()){let v=!1;const C=Os(c.target);let se=g();if(c.ctrlKey||c.metaKey){const pe=(d()-_())/100;se=Math.max(g(),Math.round(pe/g())*g())}else if(c.shiftKey||c.key==="PageUp"||c.key==="PageDown"){const pe=(d()-_())/10;se=Math.max(g(),Math.round(pe/g())*g())}switch(c.key){case"PageUp":case"ArrowRight":case"ArrowUp":rt(C,i()[C]+se),v=!0;break;case"PageDown":case"ArrowLeft":case"ArrowDown":rt(C,i()[C]-se),v=!0;break;case"Home":rt(C,_()),v=!0;break;case"End":rt(C,d()),v=!0;break}v&&(c.preventDefault(),c.stopPropagation())}}function gs(c){if(!u()){const v=c.target,C=yt(c);H(de,!0),v.matches(".rangeBar")&&h()===!0&&V()?(Ee=!1,H(Ae,!1),H(K,-1),he=!0,H(le,!0),fn(C)):(Ee=!0,H(Ae,!0),H(K,cn(C)),c.type==="touchstart"&&!v.matches(".rsPipVal")&&Kt(C)),ve=i().map(se=>Ze(se,_(),d(),g(),p(),k())),De=[...ve],Nn()}}function bs(c){c.type==="touchend"&&ws(),H(Ae,!1),H(le,!1)}function ys(c){const v=c.target;oe=!1,m()&&n(de)&&v!==m()&&!m().contains(v)&&H(de,!1)}function Ns(c){u()||(Ee?Kt(yt(c)):he&&un(yt(c)))}function gn(c){if(!u()){const v=c.target;Ee&&m()&&(v===m()||m().contains(v))&&(H(de,!0),!on(v)&&!v.matches(".rsPipVal")&&Kt(yt(c))),(Ee||he)&&ws()}Ee=!1,H(Ae,!1),he=!1,H(le,!1)}function bn(c){Ee=!1,H(Ae,!1),he=!1,H(le,!1)}function yn(c){const v=c.target;!u()&&m()&&(v===m()||m().contains(v))&&(oe=!0)}function Nn(){u()||at("start",{activeHandle:n(K),value:ve[n(K)],values:ve})}function ws(){if(u())return;const c=he?ve:ve[n(K)];at("stop",{activeHandle:n(K),startValue:c,value:i()[n(K)],values:i().map(v=>Ze(v,_(),d(),g(),p(),k()))})}function wn(){if(u())return;const c=he?ve:ve[n(K)],v=typeof De>"u"?c:he?De:De[n(K)];at("change",{activeHandle:n(K),startValue:c,previousValue:v,value:i()[n(K)],values:i().map(C=>Ze(C,_(),d(),g(),p(),k()))})}function En(c,v){const C=we(c,_(),d(),p()),se=Ge()(c,v,C),pe=Ia(String(se));return`${te()}${pe}${Te()}`}fe(()=>f(E()),()=>{E(),Bt()}),fe(()=>(f(h()),f(_()),f(d()),f(g()),f(p()),f(k()),n(Y),f(m()),f(i()),f(E())),()=>{((c,v)=>{const se=ln(c,h()).map(pe=>Ze(pe,_(),d(),g(),p(),k()));(c.length!==se.length||!c.every((pe,$e)=>ye(pe,p())===se[$e]))&&(c=se),n(Y)!==c.length?sn(c):m()&&nn(c),i(c),H(Y,c.length)})(i(),E())}),fe(()=>f(i()),()=>{i(),Xt()}),fe(()=>f(st()),()=>{st(),tn()}),fe(()=>f(_()),()=>{_(),kt()}),fe(()=>f(d()),()=>{d(),kt()}),fe(()=>f(g()),()=>{g(),_t()}),fe(()=>f(S()),()=>{S(),Ut()}),fe(()=>f(G()),()=>{G(),Ut()}),fe(()=>f(Fe()),()=>{Fe(),Ct()}),fe(()=>f(Ge()),()=>{Ge(),Ct()}),fe(()=>f(Oe()),()=>{Oe(),Ct()}),fe(()=>f(ge()),()=>{ge(),an()}),fe(()=>(f(h()),f(i())),()=>{H(a,h()===!0&&i().length===2||(h()==="min"||h()==="max")&&i().length===1)}),fe(()=>(f(D()),f(P())),()=>{H(l,D()?P()?"top":"bottom":P()?"right":"left")}),fe(()=>(f(D()),f(P())),()=>{H(b,D()?P()?"bottom":"top":P()?"left":"right")}),ps(),Ke();var Be=cr();W("mousedown",dt,ys),W("touchstart",dt,ys),W("mousemove",dt,Ns),W("touchmove",dt,Ns),W("mouseup",dt,gn),W("touchend",dt,bn),W("keydown",dt,yn);let Es;var As=w(Be);Me(As,1,i,Qs,(c,v,C,se)=>{const pe=be(()=>n(de)&&n(K)===C?"z-index: 3; ":""),$e=be(()=>n(U)?"":"opacity: 0; ");var ce=er();let Ht;ne(ce,"data-handle",C);var Wt=x(w(ce),2);{var lt=ot=>{const ct=be(()=>(f(we),n(v),f(_()),f(d()),f(p()),I(()=>we(n(v),_(),d(),p())))),ze=be(()=>(f(Ge()),n(v),f(n(ct)),I(()=>Ge()(n(v),C,n(ct)))));var ft=Ja(),It=w(ft);{var Qt=Se=>{var Qe=Qa(),gt=w(Qe,!0);y(Qe),z(()=>ue(gt,te())),T(Se,Qe)};Z(It,Se=>{te()&&Se(Qt)})}var Vt=x(It);mt(Vt,()=>n(ze));var qe=x(Vt);{var We=Se=>{var Qe=Za(),gt=w(Qe,!0);y(Qe),z(()=>ue(gt,Te())),T(Se,Qe)};Z(qe,Se=>{Te()&&Se(We)})}y(ft),T(ot,ft)};Z(Wt,ot=>{O()&&ot(lt)})}y(ce),z((ot,ct)=>{Ht=Ue(ce,1,"rangeHandle",null,Ht,ot),pt(ce,(r(),f(n(pe)),f(n($e)),I(()=>`--handle-pos: ${r()[C]};${n(pe)}${n($e)}`))),ne(ce,"aria-label",(f(st()),I(()=>st()[C]))),ne(ce,"aria-valuemin",(f(h()),f(i()),f(_()),I(()=>h()===!0&&C===1?i()[0]:_()))),ne(ce,"aria-valuemax",(f(h()),f(i()),f(d()),I(()=>h()===!0&&C===0?i()[1]:d()))),ne(ce,"aria-valuenow",n(v)),ne(ce,"aria-valuetext",ct),ne(ce,"aria-orientation",D()?"vertical":"horizontal"),ne(ce,"aria-disabled",u()),ne(ce,"tabindex",u()?-1:0)},[()=>({rsActive:n(de)&&n(K)===C,rsPress:n(Ae)&&n(K)===C}),()=>(n(v),I(()=>En(n(v),C)))]),W("blur",ce,pn),W("focus",ce,mn),W("keydown",ce,_n),T(c,ce)});var Ps=x(As,2);{var An=c=>{var v=tr();z((C,se)=>pt(v,`${n(l)??""}: ${C??""}%;
             ${n(b)??""}: ${se??""}%;`),[()=>(f(we),f(k()),f(_()),f(d()),f(p()),I(()=>we(k()[0],_(),d(),p()))),()=>(f(we),f(k()),f(_()),f(d()),f(p()),I(()=>100-we(k()[1],_(),d(),p())))]),T(c,v)};Z(Ps,c=>{k()&&c(An)})}var ks=x(Ps,2);{var Pn=c=>{const v=be(()=>(r(),I(()=>hn(r())))),C=be(()=>(r(),I(()=>vn(r())))),se=be(()=>n(C)-n(v)),pe=be(()=>n(U)?"":"opacity: 0; ");var $e=lr();let ce;var Ht=w($e);{var Wt=lt=>{const ot=be(()=>(f(h()),f(_()),f(i()),I(()=>h()==="min"?_():i()[0]))),ct=be(()=>(f(h()),f(d()),f(i()),I(()=>h()==="max"?d():h()==="min"?i()[0]:i()[1]))),ze=be(()=>{const[qe,We]=P()?[n(ct),n(ot)]:[n(ot),n(ct)];return{first:qe,second:We}});var ft=ir(),It=w(ft);{var Qt=qe=>{var We=cs(),Se=He(We);mt(Se,()=>(f(Oe()),f(n(ze).first),f(n(ze).second),f(we),f(_()),f(d()),f(p()),I(()=>Oe()(n(ze).first,n(ze).second,we(n(ze).first,_(),d(),p()),we(n(ze).second,_(),d(),p()))))),T(qe,We)},Vt=qe=>{var We=or(),Se=He(We);{var Qe=Pe=>{var ke=sr(),ut=w(ke,!0);y(ke),z(()=>ue(ut,te())),T(Pe,ke)};Z(Se,Pe=>{te()&&Pe(Qe)})}var gt=x(Se);mt(gt,()=>n(ze).first);var Ts=x(gt);{var xn=Pe=>{var ke=nr(),ut=w(ke,!0);y(ke),z(()=>ue(ut,Te())),T(Pe,ke)};Z(Ts,Pe=>{Te()&&Pe(xn)})}var xs=x(Ts);xs.nodeValue="  -  ";var Ds=x(xs);{var Dn=Pe=>{var ke=ar(),ut=w(ke,!0);y(ke),z(()=>ue(ut,te())),T(Pe,ke)};Z(Ds,Pe=>{te()&&Pe(Dn)})}var Ss=x(Ds);mt(Ss,()=>n(ze).second);var Sn=x(Ss);{var Mn=Pe=>{var ke=rr(),ut=w(ke,!0);y(ke),z(()=>ue(ut,Te())),T(Pe,ke)};Z(Sn,Pe=>{Te()&&Pe(Mn)})}T(qe,We)};Z(It,qe=>{Oe()?qe(Qt):qe(Vt,!1)})}y(ft),T(lt,ft)};Z(Ht,lt=>{j()&&lt(Wt)})}y($e),z(lt=>{ce=Ue($e,1,"rangeBar",null,ce,lt),pt($e,`--range-start:${n(v)};--range-end:${n(C)};--range-size:${n(se)};${n(pe)};`)},[()=>({rsPress:n(le)})]),T(c,$e)};Z(ks,c=>{n(a)&&c(Pn)})}var kn=x(ks,2);{var Tn=c=>{Wa(c,{get values(){return i()},get min(){return _()},get max(){return d()},get step(){return g()},get range(){return h()},get vertical(){return D()},get reversed(){return P()},get orientationStart(){return n(l)},get hoverable(){return A()},get disabled(){return u()},get limits(){return k()},get all(){return B()},get first(){return L()},get last(){return R()},get rest(){return Ne()},get pipstep(){return $()},get prefix(){return te()},get suffix(){return Te()},get formatter(){return Fe()},get precision(){return p()},get focus(){return n(de)},moveHandle:rt})};Z(kn,c=>{q()&&c(Tn)})}y(Be),ea(Be,c=>m(c),()=>m()),z(c=>{ne(Be,"id",zt()),Es=Ue(Be,1,`rangeSlider ${qt()??""}`,null,Es,c),pt(Be,`--slider-length: ${n(Pt)};${re()??""}`)},[()=>({rsDark:X()==="force",rsAutoDark:X()==="auto",rsRange:n(a),rsDrag:n(a)&&V(),rsMin:n(a)&&h()==="min",rsMax:n(a)&&h()==="max",rsDisabled:u(),rsHoverable:A(),rsVertical:D(),rsReversed:P(),rsFocus:n(de),rsPips:q(),rsPipLabels:B()==="label"||L()==="label"||R()==="label"||Ne()==="label"})]),W("mousedown",Be,gs),W("mouseup",Be,bs),W("touchstart",Be,Hs(gs)),W("touchend",Be,Hs(bs)),T(s,Be),Ve(),o()}var fr=F("<!> <!>",1),ur=F('<h2>Track</h2> <section class="svelte-1gat7zm"><div>Beat: <!></div> <div>Speed (bpm): <!></div> <!> <div class="notes svelte-1gat7zm"><!> <!></div></section>',1);function dr(s,e){Ie(e,!1);let t,o=ie(),r=ie([120]),a=ie([4]),l=ie(!1);et.subscribe(u=>{H(o,u||n(o)),H(r,[n(o).bpm]),H(a,[n(o).beat]),b()}),Ye.subscribe(u=>{t=u?.clone()||t?.clone(),b()});function b(){n(o)&&t&&n(o).syncWithTune(t)}function m(){H(l,!0),tt.playTrack(n(o),()=>p())}function p(){H(l,!1),tt.stop()}const h={stiffness:.15,damping:.8};fe(()=>(n(r),n(a)),()=>{jt(o,n(o).bpm=n(r)[0]),jt(o,n(o).beat=n(a)[0])}),ps(),Ke();var M=ur(),V=x(He(M),2),_=w(V),d=x(w(_));Ls(d,{get min(){return f(_e),I(()=>_e.MIN_BEAT)},get max(){return f(_e),I(()=>_e.MAX_BEAT)},float:!0,pips:!0,all:"label",get springValues(){return h},get values(){return n(a)},set values(u){H(a,u)},$$events:{change:()=>p()},$$legacy:!0}),y(_);var g=x(_,2),i=x(w(g));Ls(i,{get min(){return f(_e),I(()=>_e.MIN_BPM)},get max(){return f(_e),I(()=>_e.MAX_BPM)},step:5,float:!0,pips:!0,pipstep:2,all:"label",get springValues(){return h},get values(){return n(r)},set values(u){H(r,u)},$$events:{change:()=>p()},$$legacy:!0}),y(g);var E=x(g,2);{var D=u=>{At(u,{onclick:p,children:(k,S)=>{Nt();var G=wt("â¸");T(k,G)},$$slots:{default:!0}})},O=u=>{At(u,{onclick:m,children:(k,S)=>{Nt();var G=wt("â¯");T(k,G)},$$slots:{default:!0}})};Z(E,u=>{n(l)?u(D):u(O,!1)})}var j=x(E,2),P=w(j);Is(P,{position:1});var A=x(P,2);Me(A,3,()=>(n(o),I(()=>n(o).notes)),u=>u.id,(u,k,S)=>{var G=fr(),q=He(G);Fa(q,{get trackNote(){return n(k)}});var $=x(q,2);{let B=be(()=>n(S)+1);Is($,{get position(){return n(B)}})}T(u,G)}),y(j),y(V),T(s,M),Ve()}var hr=F("<option> </option>"),vr=F('<h2>Track list</h2> <select name="tracks_list" id="tracks_list" class="svelte-81oup7"></select>',1);function pr(s,e){Ie(e,!1);let t,o,r,a=ie([]);Ye.subscribe(h=>{t=h||t}),et.subscribe(h=>r=h||r);function l(h){const M=h.target;b(parseInt(String(M.value??""),10))}function b(h){if(!n(a)[h])throw"Invalid track index selected.";r=n(a)[h],o.setItem("current_track",h.toString());try{et.set(r),r.syncWithTune(t)}catch(M){console.error("Error setting current track:",M);return}}Mt(()=>{H(a,et.list(t)),o=window.localStorage;const h=parseInt(String(o.getItem("current_track")),10);isNaN(h)||b(h)}),Ke();var m=vr(),p=x(He(m),2);Me(p,7,()=>n(a),h=>h.name,(h,M,V)=>{var _=hr(),d=w(_,!0);y(_);var g={};z(()=>{ue(d,n(M).name),g!==(g=n(V))&&(_.value=(_.__value=n(V))??"")}),T(h,_)}),y(p),W("change",p,l),T(s,m),Ve()}var mr=F('<div class="container svelte-17demy1"><aside id="left" class="svelte-17demy1"><section><!></section> <section><!></section></aside> <aside id="center" class="svelte-17demy1"><!></aside> <aside id="right" class="svelte-17demy1"><button>Clear storage</button></aside></div>');function Er(s,e){Ie(e,!1),Mt(()=>{tt.loadAudioFiles(),Ye.init()});function t(){window.localStorage.clear(),console.log("Local storage cleared."),window.location.reload()}Ke();var o=mr(),r=w(o),a=w(r),l=w(a);pr(l,{}),y(a);var b=x(a,2),m=w(b);Ea(m,{}),y(b),y(r);var p=x(r,2),h=w(p);dr(h,{}),y(p);var M=x(p,2),V=w(M);y(M),y(o),W("click",V,t),T(s,o),Ve()}export{Er as component};
