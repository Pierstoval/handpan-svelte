import{S as t,i as e,s as n,e as s,t as l,k as o,c as a,a as i,g as r,n as h,d as c,b as f,f as u,H as p,I as g,J as m,K as d,L as v,h as E,M as _,N,A as y,O as $,P as b,C as T,l as D,j as k,m as A,o as B,Q as I,x as P,u as C,v as w,r as M,R as F,w as V,T as G,U as O,V as x}from"../chunks/vendor-f248546b.js";var H,S,L,z;(S=H||(H={})).left="left",S.right="right",(z=L||(L={})).A="A",z.B="B",z.C="C",z.D="D",z.E="E",z.F="F",z.G="G";const U=["Cb2","C2","C#2","Db2","D2","D#2","Eb2","A#5","B1","Bb5","B5","B#5","C6"],X=[2,3,4,5],j={C:24,D:26,E:28,F:29,G:31,A:33,B:35};var W,R,q,J,K,Q;(R=W||(W={})).none="",R.sharp="#",R.flat="b",(J=q||(q={})).topNote="topNote",J.bottomNote="bottomNote",J.ding="ding",(Q=K||(K={})).note="note",Q.slap="slap",Q.ghost="ghost",Q.none="none";class Y{constructor(t,e,n,s,l){if(this._isPlaying=!1,this._note=t,this._alteration=e,this._octave=n,this._type=s,this._position=l,l<0)throw new Error("Note position must be a non-negative integer.");this.refresh(),this.refreshHtmlElement()}get htmlElement(){return this._htmlElement}set htmlElement(t){t?this._htmlElement=t:console.warn("Tried to set empty html element to handpan note.")}get octave(){return this._octave}set octave(t){this._octave=t,this.refresh()}get alteration(){return this._alteration}set alteration(t){this._alteration=t,this.refresh()}get note(){return this._note}set note(t){this._note=t,this.refresh()}get type(){return this._type}get position(){return this._position}get fullName(){return this._note+this._alteration+this._octave}get isPlaying(){return this._isPlaying}get fullDetailedName(){return this._position+" - "+this.fullName+(this.isDing?" (ding)":"")+(this.isBottom?" (bottom)":"")}get isTop(){return this._type===q.topNote}get isDing(){return this._type===q.ding}get isBottom(){return this._type===q.bottomNote}get midiNumber(){let t=j[this._note.toString()]+12*(this._octave-1);return this._alteration===W.sharp?t++:this._alteration===W.flat&&t--,t}setPlaying(){this._htmlElement?(this._isPlaying=!0,this._htmlElement.classList.add("playing"),this._htmlElement.firstElementChild.classList.add("playing")):console.warn("Playing note is not attached to any HTML element. The issue might be that this not is not in your current handpan tune.")}stopPlaying(){this._htmlElement&&(this._isPlaying=!1,this._htmlElement.classList.remove("playing"),this._htmlElement.firstElementChild.classList.remove("playing"))}refresh(){const t={"B#":[L.C,W.none,1],"E#":[L.F,W.none,0],Ab:[L.G,W.sharp,0],Bb:[L.A,W.sharp,0],Cb:[L.B,W.none,-1],Db:[L.C,W.none,0],Eb:[L.D,W.sharp,0],Fb:[L.E,W.none,0],Gb:[L.F,W.sharp,0]}[this._note+this._alteration];if(!t)return;let e;e&&(this._octave+e<Math.min(...X)||this._octave+e<Math.max(...X))||([this._note,this._alteration,e]=t,e&&(this._octave+=e))}refreshHtmlElement(){if("undefined"==typeof document)return;const t=document.querySelector(`[data-handpan-note="${this.fullName}"]`);t&&(this.htmlElement=t)}}const Z={clac:"clac/clac.flac",gu:"gu/D2.flac",notes:{E2:"shellopan/E2.flac",F2:"shellopan/F2.flac","F#2":"shellopan/Fs2.flac",G2:"shellopan/G2.flac","G#2":"shellopan/Gs2.flac",A2:"shellopan/A2.flac","A#2":"shellopan/As2.flac",B2:"shellopan/B2.flac",C3:"shellopan/C3.flac","C#3":"shellopan/Cs3.flac",D3:"shellopan/D3.flac","D#3":"shellopan/Ds3.flac",E3:"shellopan/E3.flac",F3:"shellopan/F3.flac","F#3":"shellopan/Fs3.flac",G3:"shellopan/G3.flac","G#3":"shellopan/Gs3.flac",A3:"shellopan/A3.flac","A#3":"shellopan/As3.flac",B3:"shellopan/B3.flac",C4:"shellopan/C4.flac","C#4":"shellopan/Cs4.flac",D4:"shellopan/D4.flac","D#4":"shellopan/Ds4.flac",E4:"shellopan/E4.flac",F4:"shellopan/F4.flac","F#4":"shellopan/Fs4.flac",G4:"shellopan/G4.flac","G#4":"shellopan/Gs4.flac",A4:"shellopan/A4.flac","A#4":"shellopan/As4.flac",B4:"shellopan/B4.flac",C5:"shellopan/C5.flac","C#5":"shellopan/Cs5.flac",D5:"shellopan/D5.flac","D#5":"shellopan/Ds5.flac",E5:"shellopan/E5.flac",F5:"shellopan/F5.flac","F#5":"shellopan/Fs5.flac",G5:"shellopan/G5.flac","G#5":"shellopan/Gs5.flac",A5:"shellopan/A5.flac"}},tt=class{static get isPlaying(){return this._isPlaying}static loadAudioFiles(){this.loadAudioFile("clac",Z.clac),this.loadAudioFile("gu",Z.gu);for(const t in Z.notes)this.loadAudioFile(t,Z.notes[t])}static playTrack(t,e){this.stop(),this._isPlaying=!0;const n=this.getMsPerBeat(t.bpm,t.beat);let s=n;t.notes.forEach((t=>{this.addPlayingTimeout((()=>tt.playNote(t)),s),s+=n})),e&&this.addPlayingTimeout(e,s),this.addPlayingTimeout((()=>this.stop()),s)}static stop(){for(;this.playingTimeouts.length;)clearTimeout(this.playingTimeouts.shift());for(;this.playingNotes.length;)this.playingNotes.shift().stopPlaying();this.playingTimeouts=[],this.playingNotes=[],this._isPlaying=!1}static playNoteByType(t,e=1,n=null){if(!this.loadedAudio[t])return void console.error(`Sound type "${t}" s not loaded or does not exist.`);const s=this.loadedAudio[t].cloneNode();if(s.volume=e,s.play(),n){const t=isNaN(s.duration)?this.DEFAULT_AUDIO_DURATION:s.duration;this.addPlayingTimeout(n,t)}}static playNote(t){switch(t.setPlaying(),this.playingNotes.push(t),!0){case t.isSlap:case t.isGhost:this.playNoteByType("clac",1,(()=>this.stopNote(t)));break;case t.isNone:break;default:this.playNoteByType(t.displayName,1,(()=>this.stopNote(t)))}}static stopNote(t){t.stopPlaying(),this.playingNotes=this.playingNotes.filter((e=>e!==t))}static getMsPerBeat(t,e){return 6e4/t/e}static addPlayingTimeout(t,e){this.playingTimeouts.push(setTimeout(t,e))}static loadAudioFile(t,e){const n=new Audio;n.src=e,n.preload="auto",n.volume=1,n.addEventListener("canplaythrough",(()=>this.loadedAudio[t]=n))}};let et=tt;et.DEFAULT_AUDIO_DURATION=300,et._isPlaying=!1,et.loadedAudio={},et.playingTimeouts=[],et.playingNotes=[];function nt(t,e,n){const s=t.slice();return s[10]=e[n],s}function st(t,e,n){const s=t.slice();return s[10]=e[n],s}function lt(t,e,n){const s=t.slice();return s[15]=e[n],s}function ot(t){let e,n,m,d,v=t[15]+"";return{c(){e=s("option"),n=l(v),m=o(),this.h()},l(t){e=a(t,"OPTION",{class:!0});var s=i(e);n=r(s,v),m=h(s),s.forEach(c),this.h()},h(){e.__value=d=t[15],e.value=e.__value,f(e,"class","svelte-k6ts2a")},m(t,s){u(t,e,s),p(e,n),p(e,m)},p:g,d(t){t&&c(e)}}}function at(t){let e,n,m,d,v=t[10]+"";return{c(){e=s("option"),n=l(v),m=o(),this.h()},l(t){e=a(t,"OPTION",{class:!0});var s=i(e);n=r(s,v),m=h(s),s.forEach(c),this.h()},h(){e.__value=d=t[10],e.value=e.__value,f(e,"class","svelte-k6ts2a")},m(t,s){u(t,e,s),p(e,n),p(e,m)},p:g,d(t){t&&c(e)}}}function it(t){let e,n,m,d,v=t[10]+"";return{c(){e=s("option"),n=l(v),m=o(),this.h()},l(t){e=a(t,"OPTION",{class:!0});var s=i(e);n=r(s,v),m=h(s),s.forEach(c),this.h()},h(){e.__value=d=t[10],e.value=e.__value,f(e,"class","svelte-k6ts2a")},m(t,s){u(t,e,s),p(e,n),p(e,m)},p:g,d(t){t&&c(e)}}}function rt(t){let e,n,y,$,b,T,D,k,A,B,I,P,C,w,M,F,V,G,O,x,H,S,L,z,U,X,j,W,R,q,J,K,Q,Y,Z,tt,et,rt,ht,ct=t[0].fullName+"",ft=t[0].midiNumber+"",ut=t[1],pt=[];for(let s=0;s<ut.length;s+=1)pt[s]=ot(lt(t,ut,s));let gt=t[2],mt=[];for(let s=0;s<gt.length;s+=1)mt[s]=at(st(t,gt,s));let dt=t[3],vt=[];for(let s=0;s<dt.length;s+=1)vt[s]=it(nt(t,dt,s));return{c(){e=s("div"),n=s("div"),y=s("div"),$=l(ct),b=o(),T=s("div"),D=s("div"),k=s("h3"),A=l("Note"),B=o(),I=s("div"),P=s("select");for(let t=0;t<pt.length;t+=1)pt[t].c();C=o(),w=s("div"),M=s("h3"),F=l("Octave"),V=o(),G=s("div"),O=s("select");for(let t=0;t<mt.length;t+=1)mt[t].c();x=o(),H=s("div"),S=s("h3"),L=l("Alteration"),z=o(),U=s("div"),X=s("select");for(let t=0;t<vt.length;t+=1)vt[t].c();j=o(),W=s("div"),R=s("h4"),q=l("Info"),J=o(),K=s("ul"),Q=s("li"),Y=l("Midi: "),Z=l(ft),this.h()},l(t){e=a(t,"DIV",{class:!0,"data-handpan-note":!0});var s=i(e);n=a(s,"DIV",{class:!0});var l=i(n);y=a(l,"DIV",{class:!0});var o=i(y);$=r(o,ct),o.forEach(c),b=h(l),T=a(l,"DIV",{class:!0});var f=i(T);D=a(f,"DIV",{class:!0});var u=i(D);k=a(u,"H3",{});var p=i(k);A=r(p,"Note"),p.forEach(c),B=h(u),I=a(u,"DIV",{class:!0});var g=i(I);P=a(g,"SELECT",{size:!0,class:!0});var m=i(P);for(let e=0;e<pt.length;e+=1)pt[e].l(m);m.forEach(c),g.forEach(c),u.forEach(c),C=h(f),w=a(f,"DIV",{class:!0});var d=i(w);M=a(d,"H3",{});var v=i(M);F=r(v,"Octave"),v.forEach(c),V=h(d),G=a(d,"DIV",{class:!0});var E=i(G);O=a(E,"SELECT",{size:!0,class:!0});var _=i(O);for(let e=0;e<mt.length;e+=1)mt[e].l(_);_.forEach(c),E.forEach(c),d.forEach(c),x=h(f),H=a(f,"DIV",{class:!0});var N=i(H);S=a(N,"H3",{});var tt=i(S);L=r(tt,"Alteration"),tt.forEach(c),z=h(N),U=a(N,"DIV",{class:!0});var et=i(U);X=a(et,"SELECT",{size:!0,class:!0});var nt=i(X);for(let e=0;e<vt.length;e+=1)vt[e].l(nt);nt.forEach(c),et.forEach(c),N.forEach(c),j=h(f),W=a(f,"DIV",{});var st=i(W);R=a(st,"H4",{});var lt=i(R);q=r(lt,"Info"),lt.forEach(c),J=h(st),K=a(st,"UL",{});var ot=i(K);Q=a(ot,"LI",{});var at=i(Q);Y=r(at,"Midi: "),Z=r(at,ft),at.forEach(c),ot.forEach(c),st.forEach(c),f.forEach(c),l.forEach(c),s.forEach(c),this.h()},h(){f(y,"class","note-name svelte-k6ts2a"),f(P,"size",t[1].length),f(P,"class","svelte-k6ts2a"),void 0===t[0].note&&m((()=>t[6].call(P))),f(I,"class","select_container svelte-k6ts2a"),f(D,"class","inputs_container svelte-k6ts2a"),f(O,"size",t[2].length),f(O,"class","svelte-k6ts2a"),void 0===t[0].octave&&m((()=>t[7].call(O))),f(G,"class","select_container svelte-k6ts2a"),f(w,"class","inputs_container svelte-k6ts2a"),f(X,"size",t[3].length),f(X,"class","svelte-k6ts2a"),void 0===t[0].alteration&&m((()=>t[8].call(X))),f(U,"class","select_container svelte-k6ts2a"),f(H,"class","inputs_container svelte-k6ts2a"),f(T,"class","note-menu  svelte-k6ts2a"),f(n,"class",tt="note "+(t[0].isPlaying?"playing":"")+" svelte-k6ts2a"),f(e,"class","note-container svelte-k6ts2a"),f(e,"data-handpan-note",et=t[0].fullName)},m(s,l){u(s,e,l),p(e,n),p(n,y),p(y,$),p(n,b),p(n,T),p(T,D),p(D,k),p(k,A),p(D,B),p(D,I),p(I,P);for(let t=0;t<pt.length;t+=1)pt[t].m(P,null);d(P,t[0].note),p(T,C),p(T,w),p(w,M),p(M,F),p(w,V),p(w,G),p(G,O);for(let t=0;t<mt.length;t+=1)mt[t].m(O,null);d(O,t[0].octave),p(T,x),p(T,H),p(H,S),p(S,L),p(H,z),p(H,U),p(U,X);for(let t=0;t<vt.length;t+=1)vt[t].m(X,null);d(X,t[0].alteration),p(T,j),p(T,W),p(W,R),p(R,q),p(W,J),p(W,K),p(K,Q),p(Q,Y),p(Q,Z),t[9](e),rt||(ht=[v(P,"change",t[6]),v(P,"change",t[4]),v(O,"change",t[7]),v(O,"change",t[4]),v(X,"change",t[8]),v(X,"change",t[4])],rt=!0)},p(t,[s]){if(1&s&&ct!==(ct=t[0].fullName+"")&&E($,ct),2&s){let e;for(ut=t[1],e=0;e<ut.length;e+=1){const n=lt(t,ut,e);pt[e]?pt[e].p(n,s):(pt[e]=ot(n),pt[e].c(),pt[e].m(P,null))}for(;e<pt.length;e+=1)pt[e].d(1);pt.length=ut.length}if(3&s&&d(P,t[0].note),4&s){let e;for(gt=t[2],e=0;e<gt.length;e+=1){const n=st(t,gt,e);mt[e]?mt[e].p(n,s):(mt[e]=at(n),mt[e].c(),mt[e].m(O,null))}for(;e<mt.length;e+=1)mt[e].d(1);mt.length=gt.length}if(3&s&&d(O,t[0].octave),8&s){let e;for(dt=t[3],e=0;e<dt.length;e+=1){const n=nt(t,dt,e);vt[e]?vt[e].p(n,s):(vt[e]=it(n),vt[e].c(),vt[e].m(X,null))}for(;e<vt.length;e+=1)vt[e].d(1);vt.length=dt.length}3&s&&d(X,t[0].alteration),1&s&&ft!==(ft=t[0].midiNumber+"")&&E(Z,ft),3&s&&tt!==(tt="note "+(t[0].isPlaying?"playing":"")+" svelte-k6ts2a")&&f(n,"class",tt),3&s&&et!==(et=t[0].fullName)&&f(e,"data-handpan-note",et)},i:g,o:g,d(n){n&&c(e),_(pt,n),_(mt,n),_(vt,n),t[9](null),rt=!1,N(ht)}}}function ht(t,e,n){let{note:s}=e,{onChange:l}=e;const o=Object.values(L),a=Object.values(W);return y((()=>s.refreshHtmlElement())),t.$$set=t=>{"note"in t&&n(0,s=t.note),"onChange"in t&&n(5,l=t.onChange)},[s,o,[1,2,3,4,5],a,function(){l&&l(s),et.playNoteByType(s.fullName)},l,function(){s.note=$(this),n(0,s),n(1,o)},function(){s.octave=$(this),n(0,s),n(1,o)},function(){s.alteration=$(this),n(0,s),n(1,o)},function(t){b[t?"unshift":"push"]((()=>{s.htmlElement=t,n(0,s),n(1,o)}))}]}class ct extends t{constructor(t){super(),e(this,t,ht,rt,n,{note:0,onChange:5})}}class ft{constructor(t){this._notes=t}get dings(){return this._notes.filter((t=>t.isDing))}get topNotes(){return this._notes.filter((t=>t.isTop))}get bottomNotes(){return this._notes.filter((t=>t.isBottom))}get notes(){return this._notes||[]}getTopNoteByPosition(t){for(const e of this._notes)if(e.isTop&&e.position===t)return e;return null}getBottomNoteByPosition(t){for(const e of this._notes)if(e.isBottom&&e.position===t)return e;return null}getDingByPosition(t){for(const e of this._notes)if(e.isDing&&e.position===t)return e;return null}getSameNote(t){if(!t)return null;const e=this._notes.filter((e=>e.fullName===t.fullName));return 0===e.length?null:e[0]}}const{subscribe:ut,set:pt,update:gt}=T(mt());function mt(){return new ft([new Y(L.C,W.sharp,3,q.bottomNote,0),new Y(L.G,W.none,3,q.ding,0),new Y(L.A,W.none,3,q.topNote,0),new Y(L.B,W.none,3,q.topNote,1),new Y(L.C,W.sharp,4,q.topNote,2),new Y(L.D,W.sharp,4,q.topNote,3),new Y(L.E,W.none,4,q.topNote,4),new Y(L.F,W.sharp,4,q.topNote,5),new Y(L.G,W.sharp,4,q.topNote,6)])}const dt={setDefault:function(){pt(mt())},subscribe:ut};function vt(t,e,n){const s=t.slice();return s[4]=e[n],s[5]=e,s[6]=n,s}function Et(t,e,n){const s=t.slice();return s[4]=e[n],s[7]=e,s[6]=n,s}function _t(t,e,n){const s=t.slice();return s[4]=e[n],s[8]=e,s[6]=n,s}function Nt(t,e){let n,s,l,o;function a(t){e[1](t,e[4],e[8],e[6])}let i={onChange:Tt};return void 0!==e[4]&&(i.note=e[4]),s=new ct({props:i}),b.push((()=>G(s,"note",a))),{key:t,first:null,c(){n=D(),k(s.$$.fragment),this.h()},l(t){n=D(),A(s.$$.fragment,t),this.h()},h(){this.first=n},m(t,e){u(t,n,e),B(s,t,e),o=!0},p(t,n){e=t;const o={};!l&&1&n&&(l=!0,o.note=e[4],I((()=>l=!1))),s.$set(o)},i(t){o||(P(s.$$.fragment,t),o=!0)},o(t){C(s.$$.fragment,t),o=!1},d(t){t&&c(n),w(s,t)}}}function yt(t,e){let n,s,l,o;function a(t){e[2](t,e[4],e[7],e[6])}let i={onChange:Tt};return void 0!==e[4]&&(i.note=e[4]),s=new ct({props:i}),b.push((()=>G(s,"note",a))),{key:t,first:null,c(){n=D(),k(s.$$.fragment),this.h()},l(t){n=D(),A(s.$$.fragment,t),this.h()},h(){this.first=n},m(t,e){u(t,n,e),B(s,t,e),o=!0},p(t,n){e=t;const o={};!l&&1&n&&(l=!0,o.note=e[4],I((()=>l=!1))),s.$set(o)},i(t){o||(P(s.$$.fragment,t),o=!0)},o(t){C(s.$$.fragment,t),o=!1},d(t){t&&c(n),w(s,t)}}}function $t(t,e){let n,s,l,o;function a(t){e[3](t,e[4],e[5],e[6])}let i={onChange:Tt};return void 0!==e[4]&&(i.note=e[4]),s=new ct({props:i}),b.push((()=>G(s,"note",a))),{key:t,first:null,c(){n=D(),k(s.$$.fragment),this.h()},l(t){n=D(),A(s.$$.fragment,t),this.h()},h(){this.first=n},m(t,e){u(t,n,e),B(s,t,e),o=!0},p(t,n){e=t;const o={};!l&&1&n&&(l=!0,o.note=e[4],I((()=>l=!1))),s.$set(o)},i(t){o||(P(s.$$.fragment,t),o=!0)},o(t){C(s.$$.fragment,t),o=!1},d(t){t&&c(n),w(s,t)}}}function bt(t){let e,n,g,m,d,v,E,_,N,y,$,b,T,D,k,A,B,I,w=[],G=new Map,x=[],H=new Map,S=[],L=new Map,z=t[0].topNotes;const U=t=>t[4];for(let s=0;s<z.length;s+=1){let e=_t(t,z,s),n=U(e);G.set(n,w[s]=Nt(n,e))}let X=t[0].dings;const j=t=>t[4];for(let s=0;s<X.length;s+=1){let e=Et(t,X,s),n=j(e);H.set(n,x[s]=yt(n,e))}let W=t[0].bottomNotes;const R=t=>t[4];for(let s=0;s<W.length;s+=1){let e=vt(t,W,s),n=R(e);L.set(n,S[s]=$t(n,e))}return{c(){e=s("h2"),n=l("Tune"),g=o(),m=s("h3"),d=l("Top notes:"),v=o(),E=s("div");for(let t=0;t<w.length;t+=1)w[t].c();_=o(),N=s("h3"),y=l("Dings:"),$=o(),b=s("div");for(let t=0;t<x.length;t+=1)x[t].c();T=o(),D=s("h3"),k=l("Bottom notes:"),A=o(),B=s("div");for(let t=0;t<S.length;t+=1)S[t].c();this.h()},l(t){e=a(t,"H2",{});var s=i(e);n=r(s,"Tune"),s.forEach(c),g=h(t),m=a(t,"H3",{});var l=i(m);d=r(l,"Top notes:"),l.forEach(c),v=h(t),E=a(t,"DIV",{class:!0});var o=i(E);for(let e=0;e<w.length;e+=1)w[e].l(o);o.forEach(c),_=h(t),N=a(t,"H3",{});var f=i(N);y=r(f,"Dings:"),f.forEach(c),$=h(t),b=a(t,"DIV",{class:!0});var u=i(b);for(let e=0;e<x.length;e+=1)x[e].l(u);u.forEach(c),T=h(t),D=a(t,"H3",{});var p=i(D);k=r(p,"Bottom notes:"),p.forEach(c),A=h(t),B=a(t,"DIV",{class:!0});var I=i(B);for(let e=0;e<S.length;e+=1)S[e].l(I);I.forEach(c),this.h()},h(){f(E,"class","notes-list"),f(b,"class","notes-list"),f(B,"class","notes-list")},m(t,s){u(t,e,s),p(e,n),u(t,g,s),u(t,m,s),p(m,d),u(t,v,s),u(t,E,s);for(let e=0;e<w.length;e+=1)w[e].m(E,null);u(t,_,s),u(t,N,s),p(N,y),u(t,$,s),u(t,b,s);for(let e=0;e<x.length;e+=1)x[e].m(b,null);u(t,T,s),u(t,D,s),p(D,k),u(t,A,s),u(t,B,s);for(let e=0;e<S.length;e+=1)S[e].m(B,null);I=!0},p(t,[e]){1&e&&(z=t[0].topNotes,M(),w=F(w,e,U,1,t,z,G,E,O,Nt,null,_t),V()),1&e&&(X=t[0].dings,M(),x=F(x,e,j,1,t,X,H,b,O,yt,null,Et),V()),1&e&&(W=t[0].bottomNotes,M(),S=F(S,e,R,1,t,W,L,B,O,$t,null,vt),V())},i(t){if(!I){for(let t=0;t<z.length;t+=1)P(w[t]);for(let t=0;t<X.length;t+=1)P(x[t]);for(let t=0;t<W.length;t+=1)P(S[t]);I=!0}},o(t){for(let e=0;e<w.length;e+=1)C(w[e]);for(let e=0;e<x.length;e+=1)C(x[e]);for(let e=0;e<S.length;e+=1)C(S[e]);I=!1},d(t){t&&c(e),t&&c(g),t&&c(m),t&&c(v),t&&c(E);for(let e=0;e<w.length;e+=1)w[e].d();t&&c(_),t&&c(N),t&&c($),t&&c(b);for(let e=0;e<x.length;e+=1)x[e].d();t&&c(T),t&&c(D),t&&c(A),t&&c(B);for(let e=0;e<S.length;e+=1)S[e].d()}}}function Tt(t){console.info("change note",t)}function Dt(t,e,n){let s;return dt.subscribe((t=>n(0,s=t||s))),[s,function(t,e,l,o){l[o]=t,n(0,s)},function(t,e,l,o){l[o]=t,n(0,s)},function(t,e,l,o){l[o]=t,n(0,s)}]}class kt extends t{constructor(t){super(),e(this,t,Dt,bt,n,{})}}const At=class{constructor(t){this._bpm=120,this._beat=4,this._notes=[],this._name=t}get name(){return this._name}get notes(){return this._notes}get bpm(){return this._bpm}set bpm(t){t<=0&&(t=1),t>At.MAX_BPM&&(t=At.MAX_BPM),this._bpm=t}get beat(){return this._beat}set beat(t){t<At.MIN_BEAT&&(t=At.MIN_BEAT),t>At.MAX_BEAT&&(t=At.MAX_BEAT),this._beat=t}addNote(t){this._notes.push(t)}syncWithTune(t){this._notes.forEach((e=>{e.syncWithTuneNote(t.getSameNote(e.note))}))}};let Bt=At;Bt.MIN_BPM=50,Bt.MAX_BPM=200,Bt.MIN_BEAT=2,Bt.MAX_BEAT=8;class It{get htmlElement(){return this._htmlElement}set htmlElement(t){t?this._htmlElement=t:console.error("Tried to set empty html element to track note.")}get fullName(){var t,e;switch(!0){case this.isSlap:return"×";case this.isGhost:return"👻";case this.isNone:return"—";default:return null!=(e=null==(t=this.note)?void 0:t.fullName)?e:"-"}}get displayName(){if(!this.isNote)throw new Error(`Note name for the music player can only be retrieved on notes. Current note is "${this.type}".`);return this.note.fullName}get isNote(){return this.type===K.note}get isSlap(){return this.type===K.slap}get isGhost(){return this.type===K.ghost}get isNone(){return this.type===K.none}constructor(t,e){this.note=t,this.type=e,this.refreshHtmlElement()}setPlaying(){this._htmlElement?(this._htmlElement.firstElementChild.classList.add("playing"),this.note&&this.note.setPlaying()):console.error(`Cannot highlight note ${this.fullName} because it does not have an HTML Element associated to it.`)}stopPlaying(){this._htmlElement?(this._htmlElement.firstElementChild.classList.remove("playing"),this.note&&this.note.stopPlaying()):console.error(`Cannot disable highlight for note ${this.fullName} because it does not have an HTML Element associated to it.`)}syncWithTuneNote(t){this.refreshHtmlElement(),t&&(this.note=t,t.refreshHtmlElement())}refreshHtmlElement(){if("undefined"==typeof document)return;const t=document.querySelector(`[data-track-note="${this.fullName}"]`);t&&(this.htmlElement=t)}}const{subscribe:Pt,set:Ct,update:wt}=T(Mt());function Mt(){return Vt()}function Ft(t){const e=new Bt("Demo");return e.addNote(new It(t.getDingByPosition(0),K.note)),e.addNote(new It(t.getTopNoteByPosition(2),K.note)),e.addNote(new It(null,K.slap)),e.addNote(new It(t.getTopNoteByPosition(4),K.note)),e.addNote(new It(t.getDingByPosition(0),K.note)),e.addNote(new It(t.getTopNoteByPosition(3),K.note)),e.addNote(new It(null,K.slap)),e.addNote(new It(t.getTopNoteByPosition(5),K.note)),e}function Vt(){let t=0;const e={},n=new Bt("All notes");n.bpm=180,X.forEach((n=>{[L.C,L.D,L.E,L.F,L.G,L.A,L.B].forEach((s=>{[W.flat,W.none,W.sharp].forEach((l=>{const o=new Y(s,l,n,q.topNote,t++);if(U.includes(o.fullName))return;const a=new It(o,K.note);e[a.fullName]=a}))}))}));for(let s in e){const t=e[s];n.addNote(t)}return n}const Gt={list:function(t){return t?[Vt(),Ft(t)]:[]},setDefault:function(){Ct(Mt())},subscribe:Pt,set:Ct};function Ot(t,e,n){const s=t.slice();return s[7]=e[n],s}function xt(t,e,n){const s=t.slice();return s[10]=e[n],s}function Ht(t){let e,n,m,d,v=t[10]+"";return{c(){e=s("option"),n=l(v),m=o(),this.h()},l(t){e=a(t,"OPTION",{class:!0});var s=i(e);n=r(s,v),m=h(s),s.forEach(c),this.h()},h(){e.__value=d=t[10],e.value=e.__value,f(e,"class","svelte-fx1r0p")},m(t,s){u(t,e,s),p(e,n),p(e,m)},p:g,d(t){t&&c(e)}}}function St(t){let e,n,g,E,y,$,b,T,D,k=t[1].notes,A=[];for(let s=0;s<k.length;s+=1)A[s]=Lt(Ot(t,k,s));return{c(){e=s("div"),n=s("h3"),g=l("Note"),E=o(),y=s("div"),$=s("select");for(let t=0;t<A.length;t+=1)A[t].c();this.h()},l(t){e=a(t,"DIV",{class:!0});var s=i(e);n=a(s,"H3",{});var l=i(n);g=r(l,"Note"),l.forEach(c),E=h(s),y=a(s,"DIV",{class:!0});var o=i(y);$=a(o,"SELECT",{size:!0,class:!0});var f=i($);for(let e=0;e<A.length;e+=1)A[e].l(f);f.forEach(c),o.forEach(c),s.forEach(c),this.h()},h(){f($,"size",b=t[1].notes.length),f($,"class","svelte-fx1r0p"),void 0===t[0].note&&m((()=>t[5].call($))),f(y,"class","track_select_container svelte-fx1r0p"),f(e,"class","track_inputs_container svelte-fx1r0p")},m(s,l){u(s,e,l),p(e,n),p(n,g),p(e,E),p(e,y),p(y,$);for(let t=0;t<A.length;t+=1)A[t].m($,null);d($,t[0].note),T||(D=[v($,"change",t[5]),v($,"change",t[3])],T=!0)},p(t,e){if(2&e){let n;for(k=t[1].notes,n=0;n<k.length;n+=1){const s=Ot(t,k,n);A[n]?A[n].p(s,e):(A[n]=Lt(s),A[n].c(),A[n].m($,null))}for(;n<A.length;n+=1)A[n].d(1);A.length=k.length}2&e&&b!==(b=t[1].notes.length)&&f($,"size",b),5&e&&d($,t[0].note)},d(t){t&&c(e),_(A,t),T=!1,N(D)}}}function Lt(t){let e,n,g,m,d=t[7].fullDetailedName+"";return{c(){e=s("option"),n=l(d),g=o(),this.h()},l(t){e=a(t,"OPTION",{class:!0});var s=i(e);n=r(s,d),g=h(s),s.forEach(c),this.h()},h(){e.__value=m=t[7],e.value=e.__value,f(e,"class","svelte-fx1r0p")},m(t,s){u(t,e,s),p(e,n),p(e,g)},p(t,s){2&s&&d!==(d=t[7].fullDetailedName+"")&&E(n,d),2&s&&m!==(m=t[7])&&(e.__value=m,e.value=e.__value)},d(t){t&&c(e)}}}function zt(t){let e,n,N,y,$,b,T,D,k,A,B,I,P,C,w,M,F,V=t[0].fullName+"",G=t[2],O=[];for(let s=0;s<G.length;s+=1)O[s]=Ht(xt(t,G,s));let x=t[0]&&t[1]&&t[0].isNote&&St(t);return{c(){e=s("div"),n=s("div"),N=s("div"),y=l(V),$=o(),b=s("div"),T=s("div"),D=s("h3"),k=l("Type"),A=o(),B=s("div"),I=s("select");for(let t=0;t<O.length;t+=1)O[t].c();P=o(),x&&x.c(),this.h()},l(t){e=a(t,"DIV",{class:!0,"data-track-note":!0});var s=i(e);n=a(s,"DIV",{class:!0});var l=i(n);N=a(l,"DIV",{class:!0});var o=i(N);y=r(o,V),o.forEach(c),$=h(l),b=a(l,"DIV",{class:!0});var f=i(b);T=a(f,"DIV",{class:!0});var u=i(T);D=a(u,"H3",{});var p=i(D);k=r(p,"Type"),p.forEach(c),A=h(u),B=a(u,"DIV",{class:!0});var g=i(B);I=a(g,"SELECT",{size:!0,class:!0});var m=i(I);for(let e=0;e<O.length;e+=1)O[e].l(m);m.forEach(c),g.forEach(c),u.forEach(c),P=h(f),x&&x.l(f),f.forEach(c),l.forEach(c),s.forEach(c),this.h()},h(){f(N,"class","note-name svelte-fx1r0p"),f(I,"size",t[2].length),f(I,"class","svelte-fx1r0p"),void 0===t[0].type&&m((()=>t[4].call(I))),f(B,"class","track_select_container svelte-fx1r0p"),f(T,"class","track_inputs_container svelte-fx1r0p"),f(b,"class","track-note-menu svelte-fx1r0p"),f(n,"class",C="track-note type-"+t[0].type+" svelte-fx1r0p"),f(e,"class","track-note-container svelte-fx1r0p"),f(e,"data-track-note",w=t[0].fullName)},m(s,l){u(s,e,l),p(e,n),p(n,N),p(N,y),p(n,$),p(n,b),p(b,T),p(T,D),p(D,k),p(T,A),p(T,B),p(B,I);for(let t=0;t<O.length;t+=1)O[t].m(I,null);d(I,t[0].type),p(b,P),x&&x.m(b,null),t[6](e),M||(F=v(I,"change",t[4]),M=!0)},p(t,[s]){if(1&s&&V!==(V=t[0].fullName+"")&&E(y,V),4&s){let e;for(G=t[2],e=0;e<G.length;e+=1){const n=xt(t,G,e);O[e]?O[e].p(n,s):(O[e]=Ht(n),O[e].c(),O[e].m(I,null))}for(;e<O.length;e+=1)O[e].d(1);O.length=G.length}5&s&&d(I,t[0].type),t[0]&&t[1]&&t[0].isNote?x?x.p(t,s):(x=St(t),x.c(),x.m(b,null)):x&&(x.d(1),x=null),5&s&&C!==(C="track-note type-"+t[0].type+" svelte-fx1r0p")&&f(n,"class",C),5&s&&w!==(w=t[0].fullName)&&f(e,"data-track-note",w)},i:g,o:g,d(n){n&&c(e),_(O,n),x&&x.d(),t[6](null),M=!1,F()}}}function Ut(t,e,n){let{trackNote:s}=e,{tune:l}=e;const o=Object.values(K);return Gt.subscribe((t=>{t&&s.refreshHtmlElement()})),y((()=>s.refreshHtmlElement())),t.$$set=t=>{"trackNote"in t&&n(0,s=t.trackNote),"tune"in t&&n(1,l=t.tune)},[s,l,o,function(){et.playNote(s)},function(){s.type=$(this),n(0,s),n(2,o)},function(){s.note=$(this),n(0,s),n(2,o)},function(t){b[t?"unshift":"push"]((()=>{s.htmlElement=t,n(0,s),n(2,o)}))}]}class Xt extends t{constructor(t){super(),e(this,t,Ut,zt,n,{trackNote:0,tune:1})}}function jt(t,e,n){const s=t.slice();return s[12]=e[n],s[13]=e,s[14]=n,s}function Wt(t){let e,n,o,h;return{c(){e=s("button"),n=l("⏯"),this.h()},l(t){e=a(t,"BUTTON",{type:!0,class:!0});var s=i(e);n=r(s,"⏯"),s.forEach(c),this.h()},h(){f(e,"type","button"),f(e,"class","track-control svelte-13661rk")},m(s,l){u(s,e,l),p(e,n),o||(h=v(e,"click",t[5]),o=!0)},p:g,d(t){t&&c(e),o=!1,h()}}}function Rt(t){let e,n,o,h;return{c(){e=s("button"),n=l("⏸"),this.h()},l(t){e=a(t,"BUTTON",{type:!0,class:!0});var s=i(e);n=r(s,"⏸"),s.forEach(c),this.h()},h(){f(e,"type","button"),f(e,"class","track-control svelte-13661rk")},m(s,l){u(s,e,l),p(e,n),o||(h=v(e,"click",t[6]),o=!0)},p:g,d(t){t&&c(e),o=!1,h()}}}function qt(t){let e,n,s,l;function o(e){t[10](e,t[12],t[13],t[14])}function a(e){t[11](e)}let i={};return void 0!==t[12]&&(i.trackNote=t[12]),void 0!==t[2]&&(i.tune=t[2]),e=new Xt({props:i}),b.push((()=>G(e,"trackNote",o))),b.push((()=>G(e,"tune",a))),{c(){k(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,n){B(e,t,n),l=!0},p(l,o){t=l;const a={};!n&&8&o&&(n=!0,a.trackNote=t[12],I((()=>n=!1))),!s&&4&o&&(s=!0,a.tune=t[2],I((()=>s=!1))),e.$set(a)},i(t){l||(P(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){w(e,t)}}}function Jt(t){let e,n,g,m,d,v,E,N,y,$,T,D,F,O,H,S,L;function z(e){t[8](e)}let U={min:Bt.MIN_BEAT,max:Bt.MAX_BEAT,float:!0,pips:!0,all:"label",springValues:t[7]};function X(e){t[9](e)}void 0!==t[1]&&(U.values=t[1]),E=new x({props:U}),b.push((()=>G(E,"values",z)));let j={min:Bt.MIN_BPM,max:Bt.MAX_BPM,step:5,float:!0,pips:!0,pipstep:2,all:"label",springValues:t[7]};function W(t,e){return t[4]?Rt:Wt}void 0!==t[0]&&(j.values=t[0]),D=new x({props:j}),b.push((()=>G(D,"values",X)));let R=W(t),q=R(t),J=t[3].notes,K=[];for(let s=0;s<J.length;s+=1)K[s]=qt(jt(t,J,s));const Q=t=>C(K[t],1,1,(()=>{K[t]=null}));return{c(){e=s("h2"),n=l("Track"),g=o(),m=s("section"),d=s("div"),v=l("Beat:\n\t\t"),k(E.$$.fragment),y=o(),$=s("div"),T=l("Speed (bpm):\n\t\t"),k(D.$$.fragment),O=o(),q.c(),H=o(),S=s("div");for(let t=0;t<K.length;t+=1)K[t].c();this.h()},l(t){e=a(t,"H2",{});var s=i(e);n=r(s,"Track"),s.forEach(c),g=h(t),m=a(t,"SECTION",{class:!0});var l=i(m);d=a(l,"DIV",{});var o=i(d);v=r(o,"Beat:\n\t\t"),A(E.$$.fragment,o),o.forEach(c),y=h(l),$=a(l,"DIV",{});var f=i($);T=r(f,"Speed (bpm):\n\t\t"),A(D.$$.fragment,f),f.forEach(c),O=h(l),q.l(l),H=h(l),S=a(l,"DIV",{class:!0});var u=i(S);for(let e=0;e<K.length;e+=1)K[e].l(u);u.forEach(c),l.forEach(c),this.h()},h(){f(S,"class","notes svelte-13661rk"),f(m,"class","svelte-13661rk")},m(t,s){u(t,e,s),p(e,n),u(t,g,s),u(t,m,s),p(m,d),p(d,v),B(E,d,null),p(m,y),p(m,$),p($,T),B(D,$,null),p(m,O),q.m(m,null),p(m,H),p(m,S);for(let e=0;e<K.length;e+=1)K[e].m(S,null);L=!0},p(t,[e]){const n={};!N&&2&e&&(N=!0,n.values=t[1],I((()=>N=!1))),E.$set(n);const s={};if(!F&&1&e&&(F=!0,s.values=t[0],I((()=>F=!1))),D.$set(s),R===(R=W(t))&&q?q.p(t,e):(q.d(1),q=R(t),q&&(q.c(),q.m(m,H))),12&e){let n;for(J=t[3].notes,n=0;n<J.length;n+=1){const s=jt(t,J,n);K[n]?(K[n].p(s,e),P(K[n],1)):(K[n]=qt(s),K[n].c(),P(K[n],1),K[n].m(S,null))}for(M(),n=J.length;n<K.length;n+=1)Q(n);V()}},i(t){if(!L){P(E.$$.fragment,t),P(D.$$.fragment,t);for(let t=0;t<J.length;t+=1)P(K[t]);L=!0}},o(t){C(E.$$.fragment,t),C(D.$$.fragment,t),K=K.filter(Boolean);for(let e=0;e<K.length;e+=1)C(K[e]);L=!1},d(t){t&&c(e),t&&c(g),t&&c(m),w(E),w(D),q.d(),_(K,t)}}}function Kt(t,e,n){let s,l,o=[120],a=[4],i=!1;function r(){n(4,i=!1),et.stop()}Gt.subscribe((t=>{n(3,l=t||l),n(0,o=[l.bpm]),n(1,a=[l.beat]),s&&l.syncWithTune(s)})),dt.subscribe((t=>{n(2,s=t||s)}));return t.$$.update=()=>{3&t.$$.dirty&&(n(3,l.bpm=o[0],l),n(3,l.beat=a[0],l))},[o,a,s,l,i,function(){n(4,i=!0),et.playTrack(l,(()=>r()))},r,{stiffness:.15,damping:.8},function(t){a=t,n(1,a)},function(t){o=t,n(0,o)},function(t,e,s,i){s[i]=t,n(3,l),n(0,o),n(1,a)},function(t){s=t,n(2,s)}]}class Qt extends t{constructor(t){super(),e(this,t,Kt,Jt,n,{})}}function Yt(t,e,n){const s=t.slice();return s[5]=e[n],s}function Zt(t){let e,n,f,g,m=t[5].name+"";return{c(){e=s("option"),n=l(m),f=o(),this.h()},l(t){e=a(t,"OPTION",{});var s=i(e);n=r(s,m),f=h(s),s.forEach(c),this.h()},h(){e.__value=g=t[5],e.value=e.__value},m(t,s){u(t,e,s),p(e,n),p(e,f)},p(t,s){2&s&&m!==(m=t[5].name+"")&&E(n,m),2&s&&g!==(g=t[5])&&(e.__value=g,e.value=e.__value)},d(t){t&&c(e)}}}function te(t){let e,n,E,y,$,b,T=t[1],D=[];for(let s=0;s<T.length;s+=1)D[s]=Zt(Yt(t,T,s));return{c(){e=s("h2"),n=l("Track list"),E=o(),y=s("select");for(let t=0;t<D.length;t+=1)D[t].c();this.h()},l(t){e=a(t,"H2",{});var s=i(e);n=r(s,"Track list"),s.forEach(c),E=h(t),y=a(t,"SELECT",{name:!0,id:!0,class:!0});var l=i(y);for(let e=0;e<D.length;e+=1)D[e].l(l);l.forEach(c),this.h()},h(){f(y,"name","tracks_list"),f(y,"id","tracks_list"),f(y,"class","svelte-1nba3pp"),void 0===t[0]&&m((()=>t[3].call(y)))},m(s,l){u(s,e,l),p(e,n),u(s,E,l),u(s,y,l);for(let t=0;t<D.length;t+=1)D[t].m(y,null);d(y,t[0]),$||(b=[v(y,"change",t[3]),v(y,"change",t[2])],$=!0)},p(t,[e]){if(2&e){let n;for(T=t[1],n=0;n<T.length;n+=1){const s=Yt(t,T,n);D[n]?D[n].p(s,e):(D[n]=Zt(s),D[n].c(),D[n].m(y,null))}for(;n<D.length;n+=1)D[n].d(1);D.length=T.length}3&e&&d(y,t[0])},i:g,o:g,d(t){t&&c(e),t&&c(E),t&&c(y),_(D,t),$=!1,N(b)}}}function ee(t,e,n){let s,l,o=[];return dt.subscribe((t=>{s=t||s})),Gt.subscribe((t=>n(0,l=t||l))),y((()=>{n(1,o=Gt.list(s))})),[l,o,function(){console.info(s),Gt.set(l),l.syncWithTune(s)},function(){l=$(this),n(0,l),n(1,o)}]}class ne extends t{constructor(t){super(),e(this,t,ee,te,n,{})}}function se(t){let e,n,l,r,m,d,v,E,_,N,y;return r=new ne({}),v=new kt({}),N=new Qt({}),{c(){e=s("div"),n=s("aside"),l=s("section"),k(r.$$.fragment),m=o(),d=s("section"),k(v.$$.fragment),E=o(),_=s("aside"),k(N.$$.fragment),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=i(e);n=a(s,"ASIDE",{});var o=i(n);l=a(o,"SECTION",{});var f=i(l);A(r.$$.fragment,f),f.forEach(c),m=h(o),d=a(o,"SECTION",{});var u=i(d);A(v.$$.fragment,u),u.forEach(c),o.forEach(c),E=h(s),_=a(s,"ASIDE",{id:!0,class:!0});var p=i(_);A(N.$$.fragment,p),p.forEach(c),s.forEach(c),this.h()},h(){f(_,"id","track"),f(_,"class","svelte-gg9dru"),f(e,"class","container svelte-gg9dru")},m(t,s){u(t,e,s),p(e,n),p(n,l),B(r,l,null),p(n,m),p(n,d),B(v,d,null),p(e,E),p(e,_),B(N,_,null),y=!0},p:g,i(t){y||(P(r.$$.fragment,t),P(v.$$.fragment,t),P(N.$$.fragment,t),y=!0)},o(t){C(r.$$.fragment,t),C(v.$$.fragment,t),C(N.$$.fragment,t),y=!1},d(t){t&&c(e),w(r),w(v),w(N)}}}function le(t){return y((()=>{et.loadAudioFiles()})),[]}class oe extends t{constructor(t){super(),e(this,t,le,se,n,{})}}export{oe as default};
