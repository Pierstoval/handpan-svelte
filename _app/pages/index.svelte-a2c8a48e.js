import{S as De,i as we,s as Ae,e as v,t as X,k as I,c as N,a as b,g as W,n as P,d as f,b as y,f as B,H as _,I as te,J as Ge,K as Ee,L as _e,h as Le,M as Be,N as pt,A as Je,z as mt,O as ze,C as gt,l as je,j as ae,m as ie,o as re,P as Oe,x as Y,u as x,v as ce,r as qe,Q as xe,w as Ke,R as He,T as Ve,U as et,V as vt}from"../chunks/vendor-fe108c8f.js";var Nt;(function(t){t.left="left",t.right="right"})(Nt||(Nt={}));var L;(function(t){t.A="A",t.B="B",t.C="C",t.D="D",t.E="E",t.F="F",t.G="G"})(L||(L={}));const qt=["Cb2","C2","C#2","Db2","D2","D#2","Eb2","A#5","B1","Bb5","B5","B#5","C6"],tt=[2,3,4,5],Kt={C:24,D:26,E:28,F:29,G:31,A:33,B:35};var J;(function(t){t.none="",t.sharp="#",t.flat="b"})(J||(J={}));var Q;(function(t){t.topNote="topNote",t.bottomNote="bottomNote",t.ding="ding"})(Q||(Q={}));var le;(function(t){t.note="note",t.slap="slap",t.ghost="ghost",t.none="none"})(le||(le={}));class be{constructor(e,n,s,l,r){if(this._isPlaying=!1,this._note=e,this._alteration=n,this._octave=s,this._type=l,this._position=r,r<=0)throw new Error("Note position must be a non-negative and non-zero integer.");this.refresh(),this.refreshHtmlElement()}get htmlElement(){return this._htmlElement}set htmlElement(e){if(!e){console.warn("Tried to set empty html element to handpan note.");return}this._htmlElement=e}get octave(){return this._octave}set octave(e){this._octave=e,this.refresh()}get alteration(){return this._alteration}set alteration(e){this._alteration=e,this.refresh()}get note(){return this._note}set note(e){this._note=e,this.refresh()}get type(){return this._type}get position(){return this._position}get fullName(){return this._note+this._alteration+this._octave}get isPlaying(){return this._isPlaying}get fullDetailedName(){return this._position+" - "+this.fullName+(this.isDing?" (ding)":"")+(this.isBottom?" (bottom)":"")}get isTop(){return this._type===Q.topNote}get isDing(){return this._type===Q.ding}get isBottom(){return this._type===Q.bottomNote}get midiNumber(){let e=Kt[this._note.toString()]+(this._octave-1)*12;return this._alteration===J.sharp?e++:this._alteration===J.flat&&e--,e}forcePosition(e){this._position=e}setPlaying(){if(!this._htmlElement){console.warn("Playing note is not attached to any HTML element. The issue might be that this not is not in your current handpan tune.");return}this._isPlaying=!0,this._htmlElement.classList.add("playing"),this._htmlElement.firstElementChild.classList.add("playing")}stopPlaying(){!this._htmlElement||(this._isPlaying=!1,this._htmlElement.classList.remove("playing"),this._htmlElement.firstElementChild.classList.remove("playing"))}refreshHtmlElement(){if(typeof document=="undefined")return;const e=document.querySelector(`[data-handpan-note="${this.fullName}"]`);e&&(this.htmlElement=e)}refresh(){const e={"B#":[L.C,J.none,1],"E#":[L.F,J.none,0],Ab:[L.G,J.sharp,0],Bb:[L.A,J.sharp,0],Cb:[L.B,J.none,-1],Db:[L.C,J.none,0],Eb:[L.D,J.sharp,0],Fb:[L.E,J.none,0],Gb:[L.F,J.sharp,0]},n=this._note+this._alteration,s=e[n];if(!s)return;let l;l&&(this._octave+l<Math.min(...tt)||this._octave+l<Math.max(...tt))||([this._note,this._alteration,l]=s,l&&(this._octave+=l))}}const Qe={clac:"clac/clac.flac",gu:"gu/D2.flac",notes:{E2:"shellopan/E2.flac",F2:"shellopan/F2.flac","F#2":"shellopan/Fs2.flac",G2:"shellopan/G2.flac","G#2":"shellopan/Gs2.flac",A2:"shellopan/A2.flac","A#2":"shellopan/As2.flac",B2:"shellopan/B2.flac",C3:"shellopan/C3.flac","C#3":"shellopan/Cs3.flac",D3:"shellopan/D3.flac","D#3":"shellopan/Ds3.flac",E3:"shellopan/E3.flac",F3:"shellopan/F3.flac","F#3":"shellopan/Fs3.flac",G3:"shellopan/G3.flac","G#3":"shellopan/Gs3.flac",A3:"shellopan/A3.flac","A#3":"shellopan/As3.flac",B3:"shellopan/B3.flac",C4:"shellopan/C4.flac","C#4":"shellopan/Cs4.flac",D4:"shellopan/D4.flac","D#4":"shellopan/Ds4.flac",E4:"shellopan/E4.flac",F4:"shellopan/F4.flac","F#4":"shellopan/Fs4.flac",G4:"shellopan/G4.flac","G#4":"shellopan/Gs4.flac",A4:"shellopan/A4.flac","A#4":"shellopan/As4.flac",B4:"shellopan/B4.flac",C5:"shellopan/C5.flac","C#5":"shellopan/Cs5.flac",D5:"shellopan/D5.flac","D#5":"shellopan/Ds5.flac",E5:"shellopan/E5.flac",F5:"shellopan/F5.flac","F#5":"shellopan/Fs5.flac",G5:"shellopan/G5.flac","G#5":"shellopan/Gs5.flac",A5:"shellopan/A5.flac"}},bt=class{static get isPlaying(){return this._isPlaying}static loadAudioFiles(){this.loadAudioFile("clac",Qe.clac),this.loadAudioFile("gu",Qe.gu);for(const t in Qe.notes)this.loadAudioFile(t,Qe.notes[t])}static playTrack(t,e){this.stop(),this._isPlaying=!0;const n=this.getMsPerBeat(t.bpm,t.beat);let s=n;t.notes.forEach(l=>{this.addPlayingTimeout(()=>bt.playNote(l),s),s+=n}),e&&this.addPlayingTimeout(e,s),this.addPlayingTimeout(()=>this.stop(),s)}static stop(){for(;this.playingTimeouts.length;)clearTimeout(this.playingTimeouts.shift());for(;this.playingNotes.length;)this.playingNotes.shift().stopPlaying();this.playingTimeouts=[],this.playingNotes=[],this._isPlaying=!1}static playNoteByType(t,e=1,n=null){if(!this.loadedAudio[t]){console.error(`Sound type "${t}" s not loaded or does not exist.`);return}const s=this.loadedAudio[t].cloneNode();if(s.volume=e,s.play(),n){const l=isNaN(s.duration)?this.DEFAULT_AUDIO_DURATION:s.duration;this.addPlayingTimeout(n,l)}}static playNote(t){switch(t.setPlaying(),this.playingNotes.push(t),!0){case t.isSlap:this.playNoteByType("clac",1,()=>this.stopNote(t));break;case t.isGhost:this.playNoteByType("clac",1,()=>this.stopNote(t));break;case t.isNone:break;default:this.playNoteByType(t.displayName,1,()=>this.stopNote(t));break}}static stopNote(t){t.stopPlaying(),this.playingNotes=this.playingNotes.filter(e=>e!==t)}static getMsPerBeat(t,e){return 1e3*60/t/e}static addPlayingTimeout(t,e){this.playingTimeouts.push(setTimeout(t,e))}static loadAudioFile(t,e){const n=new Audio;n.src=e,n.preload="auto",n.volume=1,n.addEventListener("canplaythrough",()=>this.loadedAudio[t]=n)}};let ye=bt;ye.DEFAULT_AUDIO_DURATION=300;ye._isPlaying=!1;ye.loadedAudio={};ye.playingTimeouts=[];ye.playingNotes=[];function Et(t,e,n){const s=t.slice();return s[9]=e[n],s}function yt(t,e,n){const s=t.slice();return s[9]=e[n],s}function kt(t,e,n){const s=t.slice();return s[14]=e[n],s}function $t(t){let e,n=t[14]+"",s,l,r;return{c(){e=v("option"),s=X(n),l=I(),this.h()},l(a){e=N(a,"OPTION",{class:!0});var o=b(e);s=W(o,n),l=P(o),o.forEach(f),this.h()},h(){e.__value=r=t[14],e.value=e.__value,y(e,"class","svelte-1jj1888")},m(a,o){B(a,e,o),_(e,s),_(e,l)},p:te,d(a){a&&f(e)}}}function Tt(t){let e,n=t[9]+"",s,l,r;return{c(){e=v("option"),s=X(n),l=I(),this.h()},l(a){e=N(a,"OPTION",{class:!0});var o=b(e);s=W(o,n),l=P(o),o.forEach(f),this.h()},h(){e.__value=r=t[9],e.value=e.__value,y(e,"class","svelte-1jj1888")},m(a,o){B(a,e,o),_(e,s),_(e,l)},p:te,d(a){a&&f(e)}}}function Dt(t){let e,n=t[9]+"",s,l,r;return{c(){e=v("option"),s=X(n),l=I(),this.h()},l(a){e=N(a,"OPTION",{class:!0});var o=b(e);s=W(o,n),l=P(o),o.forEach(f),this.h()},h(){e.__value=r=t[9],e.value=e.__value,y(e,"class","svelte-1jj1888")},m(a,o){B(a,e,o),_(e,s),_(e,l)},p:te,d(a){a&&f(e)}}}function Qt(t){let e,n,s,l=t[0].fullName+"",r,a,o,c,h,i,p,d,g,w,A,C,F,he,H,j,z,T,q,V,K,M,S,D,ue,E,O,Z,ne,G,oe,pe=t[0].midiNumber+"",u,m,U,$e,Se,me=t[1],ee=[];for(let $=0;$<me.length;$+=1)ee[$]=$t(kt(t,me,$));let ge=t[2],R=[];for(let $=0;$<ge.length;$+=1)R[$]=Tt(yt(t,ge,$));let Ce=t[3],fe=[];for(let $=0;$<Ce.length;$+=1)fe[$]=Dt(Et(t,Ce,$));return{c(){e=v("div"),n=v("div"),s=v("div"),r=X(l),a=I(),o=v("div"),c=v("div"),h=v("h3"),i=X("Note"),p=I(),d=v("div"),g=v("select");for(let $=0;$<ee.length;$+=1)ee[$].c();w=I(),A=v("div"),C=v("h3"),F=X("Octave"),he=I(),H=v("div"),j=v("select");for(let $=0;$<R.length;$+=1)R[$].c();z=I(),T=v("div"),q=v("h3"),V=X("Alteration"),K=I(),M=v("div"),S=v("select");for(let $=0;$<fe.length;$+=1)fe[$].c();D=I(),ue=v("div"),E=v("h4"),O=X("Info"),Z=I(),ne=v("ul"),G=v("li"),oe=X("Midi: "),u=X(pe),this.h()},l($){e=N($,"DIV",{class:!0,"data-handpan-note":!0});var se=b(e);n=N(se,"DIV",{class:!0});var k=b(n);s=N(k,"DIV",{class:!0});var ve=b(s);r=W(ve,l),ve.forEach(f),a=P(k),o=N(k,"DIV",{class:!0});var Te=b(o);c=N(Te,"DIV",{class:!0});var Ue=b(c);h=N(Ue,"H3",{});var lt=b(h);i=W(lt,"Note"),lt.forEach(f),p=P(Ue),d=N(Ue,"DIV",{class:!0});var ot=b(d);g=N(ot,"SELECT",{size:!0,class:!0});var at=b(g);for(let Ne=0;Ne<ee.length;Ne+=1)ee[Ne].l(at);at.forEach(f),ot.forEach(f),Ue.forEach(f),w=P(Te),A=N(Te,"DIV",{class:!0});var Re=b(A);C=N(Re,"H3",{});var it=b(C);F=W(it,"Octave"),it.forEach(f),he=P(Re),H=N(Re,"DIV",{class:!0});var rt=b(H);j=N(rt,"SELECT",{size:!0,class:!0});var ct=b(j);for(let Ne=0;Ne<R.length;Ne+=1)R[Ne].l(ct);ct.forEach(f),rt.forEach(f),Re.forEach(f),z=P(Te),T=N(Te,"DIV",{class:!0});var Xe=b(T);q=N(Xe,"H3",{});var ht=b(q);V=W(ht,"Alteration"),ht.forEach(f),K=P(Xe),M=N(Xe,"DIV",{class:!0});var ft=b(M);S=N(ft,"SELECT",{size:!0,class:!0});var ut=b(S);for(let Ne=0;Ne<fe.length;Ne+=1)fe[Ne].l(ut);ut.forEach(f),ft.forEach(f),Xe.forEach(f),D=P(Te),ue=N(Te,"DIV",{});var We=b(ue);E=N(We,"H4",{});var _t=b(E);O=W(_t,"Info"),_t.forEach(f),Z=P(We),ne=N(We,"UL",{});var dt=b(ne);G=N(dt,"LI",{});var Ze=b(G);oe=W(Ze,"Midi: "),u=W(Ze,pe),Ze.forEach(f),dt.forEach(f),We.forEach(f),Te.forEach(f),k.forEach(f),se.forEach(f),this.h()},h(){y(s,"class","note-name svelte-1jj1888"),y(g,"size",t[1].length),y(g,"class","svelte-1jj1888"),t[0].note===void 0&&Ge(()=>t[6].call(g)),y(d,"class","select_container svelte-1jj1888"),y(c,"class","inputs_container svelte-1jj1888"),y(j,"size",t[2].length),y(j,"class","svelte-1jj1888"),t[0].octave===void 0&&Ge(()=>t[7].call(j)),y(H,"class","select_container svelte-1jj1888"),y(A,"class","inputs_container svelte-1jj1888"),y(S,"size",t[3].length),y(S,"class","svelte-1jj1888"),t[0].alteration===void 0&&Ge(()=>t[8].call(S)),y(M,"class","select_container svelte-1jj1888"),y(T,"class","inputs_container svelte-1jj1888"),y(o,"class","note-menu  svelte-1jj1888"),y(n,"class",m="note "+(t[0].isPlaying?"playing":"")+" svelte-1jj1888"),y(e,"class","note-container svelte-1jj1888"),y(e,"data-handpan-note",U=t[0].fullName)},m($,se){B($,e,se),_(e,n),_(n,s),_(s,r),_(n,a),_(n,o),_(o,c),_(c,h),_(h,i),_(c,p),_(c,d),_(d,g);for(let k=0;k<ee.length;k+=1)ee[k].m(g,null);Ee(g,t[0].note),_(o,w),_(o,A),_(A,C),_(C,F),_(A,he),_(A,H),_(H,j);for(let k=0;k<R.length;k+=1)R[k].m(j,null);Ee(j,t[0].octave),_(o,z),_(o,T),_(T,q),_(q,V),_(T,K),_(T,M),_(M,S);for(let k=0;k<fe.length;k+=1)fe[k].m(S,null);Ee(S,t[0].alteration),_(o,D),_(o,ue),_(ue,E),_(E,O),_(ue,Z),_(ue,ne),_(ne,G),_(G,oe),_(G,u),$e||(Se=[_e(g,"change",t[6]),_e(g,"change",t[4]),_e(j,"change",t[7]),_e(j,"change",t[4]),_e(S,"change",t[8]),_e(S,"change",t[4])],$e=!0)},p($,[se]){if(se&1&&l!==(l=$[0].fullName+"")&&Le(r,l),se&2){me=$[1];let k;for(k=0;k<me.length;k+=1){const ve=kt($,me,k);ee[k]?ee[k].p(ve,se):(ee[k]=$t(ve),ee[k].c(),ee[k].m(g,null))}for(;k<ee.length;k+=1)ee[k].d(1);ee.length=me.length}if(se&3&&Ee(g,$[0].note),se&4){ge=$[2];let k;for(k=0;k<ge.length;k+=1){const ve=yt($,ge,k);R[k]?R[k].p(ve,se):(R[k]=Tt(ve),R[k].c(),R[k].m(j,null))}for(;k<R.length;k+=1)R[k].d(1);R.length=ge.length}if(se&3&&Ee(j,$[0].octave),se&8){Ce=$[3];let k;for(k=0;k<Ce.length;k+=1){const ve=Et($,Ce,k);fe[k]?fe[k].p(ve,se):(fe[k]=Dt(ve),fe[k].c(),fe[k].m(S,null))}for(;k<fe.length;k+=1)fe[k].d(1);fe.length=Ce.length}se&3&&Ee(S,$[0].alteration),se&1&&pe!==(pe=$[0].midiNumber+"")&&Le(u,pe),se&3&&m!==(m="note "+($[0].isPlaying?"playing":"")+" svelte-1jj1888")&&y(n,"class",m),se&3&&U!==(U=$[0].fullName)&&y(e,"data-handpan-note",U)},i:te,o:te,d($){$&&f(e),Be(ee,$),Be(R,$),Be(fe,$),$e=!1,pt(Se)}}}function Yt(t,e,n){let{note:s}=e,{onChange:l}=e;const r=Object.values(L),a=[1,2,3,4,5],o=Object.values(J);function c(){l&&l(s),ye.playNoteByType(s.fullName)}Je(()=>s.refreshHtmlElement()),mt(()=>s.refreshHtmlElement());function h(){s.note=ze(this),n(0,s),n(1,r)}function i(){s.octave=ze(this),n(0,s),n(1,r)}function p(){s.alteration=ze(this),n(0,s),n(1,r)}return t.$$set=d=>{"note"in d&&n(0,s=d.note),"onChange"in d&&n(5,l=d.onChange)},[s,r,a,o,c,l,h,i,p]}class nt extends De{constructor(e){super();we(this,e,Yt,Qt,Ae,{note:0,onChange:5})}}class wt{constructor(e){this._topNotes=[],this._dings=[],this._bottomNotes=[],e.forEach(n=>this.addNote(n)),this.refresh()}static fromDeserializedJson(e){if(!e)throw"Empty JSON cannot be used to create HandpanTune.";if(!e._topNotes||!e._dings||!e._bottomNotes)throw"Handpan Tune incoming JSON does not contain all necessary fields.";debugger}get dings(){return this._dings}get topNotes(){return this._topNotes}get bottomNotes(){return this._bottomNotes}get numberOfNotes(){return this._topNotes.length+this._dings.length+this._bottomNotes.length}get notes(){return this._notes||[]}addNote(e){e.isTop?(this._topNotes.push(e),e.forcePosition(this._topNotes.length)):e.isDing?(this._dings.push(e),e.forcePosition(this._dings.length)):e.isBottom&&(this._bottomNotes.push(e),e.forcePosition(this._topNotes.length))}addNoteAt(e,n){const s=new be(L.A,J.none,3,n,e);let l=[];switch(n){case Q.topNote:l=this.topNotes;break;case Q.bottomNote:l=this.bottomNotes;break;case Q.ding:l=this.dings;break;default:throw new Error("Expected note to be either top, ding or bottom, and found an unsupported value.")}l.splice(e===1?e-1:e,0,s)}getTopNoteByPosition(e){for(const n of this._topNotes)if(n.position===e)return n;return null}getBottomNoteByPosition(e){for(const n of this._bottomNotes)if(n.position===e)return n;return null}getDingByPosition(e){for(const n of this._dings)if(n.position===e)return n;return null}getSameNote(e){switch(!0){case e.isTop:return this.getTopNoteByPosition(e.position);case e.isDing:return this.getDingByPosition(e.position);case e.isBottom:return this.getBottomNoteByPosition(e.position);default:throw new Error("Expected note to be either top, ding or bottom, and found an unsupported value.")}}refresh(){const e=(n,s)=>{const l=n.position,r=s.position;switch(!0){case l<r:return-1;case l===r:throw new Error("Two notes cannot have the same position!");case l>r:return 1}};this._topNotes.sort(e),this._dings.sort(e),this._bottomNotes.sort(e)}}const At="7bbc19fe-0778-4069-9cdc-6dc4a9318e2b",Ye=typeof window!="undefined"?window==null?void 0:window.localStorage:null,{subscribe:Zt,set:xt,update:Bn}=gt(tn());function en(t){xt(t),Ye&&Ye.setItem(At,JSON.stringify(t))}function tn(){if(Ye){const t=Ye.getItem(At);if(t)return console.info("TODO: Deserialize properly the HandpanTune object"),wt.fromDeserializedJson(JSON.parse(t))}return nn()}function nn(){return new wt([new be(L.C,J.sharp,3,Q.bottomNote,1),new be(L.G,J.none,3,Q.ding,1),new be(L.A,J.none,3,Q.topNote,1),new be(L.B,J.none,3,Q.topNote,2),new be(L.C,J.sharp,4,Q.topNote,3),new be(L.D,J.sharp,4,Q.topNote,4),new be(L.E,J.none,4,Q.topNote,5),new be(L.F,J.sharp,4,Q.topNote,6),new be(L.G,J.sharp,4,Q.topNote,7)])}const Fe={subscribe:Zt,set:en};function sn(t){let e,n,s,l,r;return{c(){e=v("div"),n=v("div"),s=X("+"),this.h()},l(a){e=N(a,"DIV",{class:!0});var o=b(e);n=N(o,"DIV",{class:!0});var c=b(n);s=W(c,"+"),c.forEach(f),o.forEach(f),this.h()},h(){y(n,"class","handpan-note svelte-117otwt"),y(e,"class","handpan-note-container svelte-117otwt")},m(a,o){B(a,e,o),_(e,n),_(n,s),l||(r=_e(n,"click",t[0]),l=!0)},p:te,i:te,o:te,d(a){a&&f(e),l=!1,r()}}}function ln(t,e,n){let{position:s}=e,{type:l}=e,{tune:r}=e;Fe.subscribe(o=>n(1,r=o||r));function a(){r.addNoteAt(s,l),Fe.set(r)}return t.$$set=o=>{"position"in o&&n(2,s=o.position),"type"in o&&n(3,l=o.type),"tune"in o&&n(1,r=o.tune)},[a,r,s,l]}class Me extends De{constructor(e){super();we(this,e,ln,sn,Ae,{position:2,type:3,tune:1})}}function Bt(t,e,n){const s=t.slice();return s[4]=e[n],s[5]=e,s[6]=n,s}function It(t,e,n){const s=t.slice();return s[4]=e[n],s[7]=e,s[6]=n,s}function Pt(t,e,n){const s=t.slice();return s[4]=e[n],s[8]=e,s[6]=n,s}function Ct(t,e){let n,s,l,r,a,o;function c(i){e[1](i,e[4],e[8],e[6])}let h={onChange:st};return e[4]!==void 0&&(h.note=e[4]),s=new nt({props:h}),He.push(()=>Ve(s,"note",c)),a=new Me({props:{position:e[6]+1,type:Q.topNote}}),{key:t,first:null,c(){n=je(),ae(s.$$.fragment),r=I(),ae(a.$$.fragment),this.h()},l(i){n=je(),ie(s.$$.fragment,i),r=P(i),ie(a.$$.fragment,i),this.h()},h(){this.first=n},m(i,p){B(i,n,p),re(s,i,p),B(i,r,p),re(a,i,p),o=!0},p(i,p){e=i;const d={};!l&&p&1&&(l=!0,d.note=e[4],Oe(()=>l=!1)),s.$set(d);const g={};p&1&&(g.position=e[6]+1),a.$set(g)},i(i){o||(Y(s.$$.fragment,i),Y(a.$$.fragment,i),o=!0)},o(i){x(s.$$.fragment,i),x(a.$$.fragment,i),o=!1},d(i){i&&f(n),ce(s,i),i&&f(r),ce(a,i)}}}function jt(t,e){let n,s,l,r,a,o;function c(i){e[2](i,e[4],e[7],e[6])}let h={onChange:st};return e[4]!==void 0&&(h.note=e[4]),s=new nt({props:h}),He.push(()=>Ve(s,"note",c)),a=new Me({props:{position:e[6]+1,type:Q.ding}}),{key:t,first:null,c(){n=je(),ae(s.$$.fragment),r=I(),ae(a.$$.fragment),this.h()},l(i){n=je(),ie(s.$$.fragment,i),r=P(i),ie(a.$$.fragment,i),this.h()},h(){this.first=n},m(i,p){B(i,n,p),re(s,i,p),B(i,r,p),re(a,i,p),o=!0},p(i,p){e=i;const d={};!l&&p&1&&(l=!0,d.note=e[4],Oe(()=>l=!1)),s.$set(d);const g={};p&1&&(g.position=e[6]+1),a.$set(g)},i(i){o||(Y(s.$$.fragment,i),Y(a.$$.fragment,i),o=!0)},o(i){x(s.$$.fragment,i),x(a.$$.fragment,i),o=!1},d(i){i&&f(n),ce(s,i),i&&f(r),ce(a,i)}}}function Ot(t,e){let n,s,l,r,a,o;function c(i){e[3](i,e[4],e[5],e[6])}let h={onChange:st};return e[4]!==void 0&&(h.note=e[4]),s=new nt({props:h}),He.push(()=>Ve(s,"note",c)),a=new Me({props:{position:e[6]+1,type:Q.bottomNote}}),{key:t,first:null,c(){n=je(),ae(s.$$.fragment),r=I(),ae(a.$$.fragment),this.h()},l(i){n=je(),ie(s.$$.fragment,i),r=P(i),ie(a.$$.fragment,i),this.h()},h(){this.first=n},m(i,p){B(i,n,p),re(s,i,p),B(i,r,p),re(a,i,p),o=!0},p(i,p){e=i;const d={};!l&&p&1&&(l=!0,d.note=e[4],Oe(()=>l=!1)),s.$set(d);const g={};p&1&&(g.position=e[6]+1),a.$set(g)},i(i){o||(Y(s.$$.fragment,i),Y(a.$$.fragment,i),o=!0)},o(i){x(s.$$.fragment,i),x(a.$$.fragment,i),o=!1},d(i){i&&f(n),ce(s,i),i&&f(r),ce(a,i)}}}function on(t){let e,n,s,l,r,a,o,c,h,i=[],p=new Map,d,g,w,A,C,F,he,H=[],j=new Map,z,T,q,V,K,M,S,D=[],ue=new Map,E;c=new Me({props:{position:1,type:Q.topNote}});let O=t[0].topNotes;const Z=u=>u[4];for(let u=0;u<O.length;u+=1){let m=Pt(t,O,u),U=Z(m);p.set(U,i[u]=Ct(U,m))}F=new Me({props:{position:1,type:Q.ding}});let ne=t[0].dings;const G=u=>u[4];for(let u=0;u<ne.length;u+=1){let m=It(t,ne,u),U=G(m);j.set(U,H[u]=jt(U,m))}M=new Me({props:{position:1,type:Q.bottomNote}});let oe=t[0].bottomNotes;const pe=u=>u[4];for(let u=0;u<oe.length;u+=1){let m=Bt(t,oe,u),U=pe(m);ue.set(U,D[u]=Ot(U,m))}return{c(){e=v("h2"),n=X("Tune"),s=I(),l=v("h3"),r=X("Top notes:"),a=I(),o=v("div"),ae(c.$$.fragment),h=I();for(let u=0;u<i.length;u+=1)i[u].c();d=I(),g=v("h3"),w=X("Dings:"),A=I(),C=v("div"),ae(F.$$.fragment),he=I();for(let u=0;u<H.length;u+=1)H[u].c();z=I(),T=v("h3"),q=X("Bottom notes:"),V=I(),K=v("div"),ae(M.$$.fragment),S=I();for(let u=0;u<D.length;u+=1)D[u].c();this.h()},l(u){e=N(u,"H2",{});var m=b(e);n=W(m,"Tune"),m.forEach(f),s=P(u),l=N(u,"H3",{});var U=b(l);r=W(U,"Top notes:"),U.forEach(f),a=P(u),o=N(u,"DIV",{class:!0});var $e=b(o);ie(c.$$.fragment,$e),h=P($e);for(let R=0;R<i.length;R+=1)i[R].l($e);$e.forEach(f),d=P(u),g=N(u,"H3",{});var Se=b(g);w=W(Se,"Dings:"),Se.forEach(f),A=P(u),C=N(u,"DIV",{class:!0});var me=b(C);ie(F.$$.fragment,me),he=P(me);for(let R=0;R<H.length;R+=1)H[R].l(me);me.forEach(f),z=P(u),T=N(u,"H3",{});var ee=b(T);q=W(ee,"Bottom notes:"),ee.forEach(f),V=P(u),K=N(u,"DIV",{class:!0});var ge=b(K);ie(M.$$.fragment,ge),S=P(ge);for(let R=0;R<D.length;R+=1)D[R].l(ge);ge.forEach(f),this.h()},h(){y(o,"class","notes-list"),y(C,"class","notes-list"),y(K,"class","notes-list")},m(u,m){B(u,e,m),_(e,n),B(u,s,m),B(u,l,m),_(l,r),B(u,a,m),B(u,o,m),re(c,o,null),_(o,h);for(let U=0;U<i.length;U+=1)i[U].m(o,null);B(u,d,m),B(u,g,m),_(g,w),B(u,A,m),B(u,C,m),re(F,C,null),_(C,he);for(let U=0;U<H.length;U+=1)H[U].m(C,null);B(u,z,m),B(u,T,m),_(T,q),B(u,V,m),B(u,K,m),re(M,K,null),_(K,S);for(let U=0;U<D.length;U+=1)D[U].m(K,null);E=!0},p(u,[m]){m&1&&(O=u[0].topNotes,qe(),i=xe(i,m,Z,1,u,O,p,o,et,Ct,null,Pt),Ke()),m&1&&(ne=u[0].dings,qe(),H=xe(H,m,G,1,u,ne,j,C,et,jt,null,It),Ke()),m&1&&(oe=u[0].bottomNotes,qe(),D=xe(D,m,pe,1,u,oe,ue,K,et,Ot,null,Bt),Ke())},i(u){if(!E){Y(c.$$.fragment,u);for(let m=0;m<O.length;m+=1)Y(i[m]);Y(F.$$.fragment,u);for(let m=0;m<ne.length;m+=1)Y(H[m]);Y(M.$$.fragment,u);for(let m=0;m<oe.length;m+=1)Y(D[m]);E=!0}},o(u){x(c.$$.fragment,u);for(let m=0;m<i.length;m+=1)x(i[m]);x(F.$$.fragment,u);for(let m=0;m<H.length;m+=1)x(H[m]);x(M.$$.fragment,u);for(let m=0;m<D.length;m+=1)x(D[m]);E=!1},d(u){u&&f(e),u&&f(s),u&&f(l),u&&f(a),u&&f(o),ce(c);for(let m=0;m<i.length;m+=1)i[m].d();u&&f(d),u&&f(g),u&&f(A),u&&f(C),ce(F);for(let m=0;m<H.length;m+=1)H[m].d();u&&f(z),u&&f(T),u&&f(V),u&&f(K),ce(M);for(let m=0;m<D.length;m+=1)D[m].d()}}}function st(t){console.info("change note",t)}function an(t,e,n){let s;Fe.subscribe(o=>n(0,s=o||s));function l(o,c,h,i){h[i]=o,n(0,s)}function r(o,c,h,i){h[i]=o,n(0,s)}function a(o,c,h,i){h[i]=o,n(0,s)}return[s,l,r,a]}class rn extends De{constructor(e){super();we(this,e,an,on,Ae,{})}}class de{get htmlElement(){return this._htmlElement}set htmlElement(e){if(!e){console.error("Tried to set empty html element to track note.");return}this._htmlElement=e}get fullName(){var e,n;switch(!0){case this.isSlap:return"\xD7";case this.isGhost:return"\u{1F47B}";case this.isNone:return"\u2014";default:return(n=(e=this.note)==null?void 0:e.fullName)!=null?n:"-"}}get displayName(){if(!this.isNote)throw new Error(`Note name for the music player can only be retrieved on notes. Current note is "${this.type}".`);return this.note.fullName}get isNote(){return this.type===le.note}get isSlap(){return this.type===le.slap}get isGhost(){return this.type===le.ghost}get isNone(){return this.type===le.none}constructor(e,n){if(!e&&de.typeNeedsHandpanNote(n))throw`Tried to create track note of type "${n}" with no HandpanNote, but this type needs one.`;this.note=e,this.type=n,this.refreshHtmlElement()}static createGhost(){return new de(null,le.ghost)}setPlaying(){if(!this._htmlElement){console.error(`Cannot highlight note ${this.fullName} because it does not have an HTML Element associated to it.`);return}this._htmlElement.firstElementChild.classList.add("playing"),this.note&&this.note.setPlaying()}stopPlaying(){if(!this._htmlElement){console.error(`Cannot disable highlight for note ${this.fullName} because it does not have an HTML Element associated to it.`);return}this._htmlElement.firstElementChild.classList.remove("playing"),this.note&&this.note.stopPlaying()}syncWithTuneNote(e){this.refreshHtmlElement(),this.note=e,e.refreshHtmlElement()}refreshHtmlElement(){if(typeof document=="undefined")return;const e=document.querySelector(`[data-track-note="${this.fullName}"]`);e&&(this.htmlElement=e)}static typeNeedsHandpanNote(e){return e===le.note}}const Ie=class{constructor(t){this._bpm=120,this._beat=4,this._notes=[],this._name=t}get name(){return this._name}get notes(){return this._notes}get bpm(){return this._bpm}set bpm(t){t<=0&&(t=1),t>Ie.MAX_BPM&&(t=Ie.MAX_BPM),this._bpm=t}get beat(){return this._beat}set beat(t){t<Ie.MIN_BEAT&&(t=Ie.MIN_BEAT),t>Ie.MAX_BEAT&&(t=Ie.MAX_BEAT),this._beat=t}addNoteAt(t){const e=de.createGhost();this._notes.splice(t===1?t-1:t,0,e)}addNote(t){this._notes.push(t)}syncWithTune(t){this._notes.forEach(e=>{if(!e.isNote)return;const n=t.getSameNote(e.note);if(!n){console.warn(`Note ${e.fullName} is in the current track but was not found in the handpan tune.`);return}e.syncWithTuneNote(n)})}};let ke=Ie;ke.MIN_BPM=50;ke.MAX_BPM=200;ke.MIN_BEAT=2;ke.MAX_BEAT=8;const{subscribe:cn,set:Ht,update:In}=gt(Vt());function hn(t){return t?[Ft(),un(t)]:[]}function fn(){Ht(Vt())}function Vt(){return Ft()}function un(t){const e=new ke("Demo");return e.addNote(new de(t.getDingByPosition(1),le.note)),e.addNote(new de(t.getTopNoteByPosition(2),le.note)),e.addNote(new de(null,le.slap)),e.addNote(new de(t.getTopNoteByPosition(4),le.note)),e.addNote(new de(t.getDingByPosition(1),le.note)),e.addNote(new de(t.getTopNoteByPosition(3),le.note)),e.addNote(new de(null,le.slap)),e.addNote(new de(t.getTopNoteByPosition(5),le.note)),e}function Ft(){let t=1;const e={},n=new ke("All notes");n.bpm=180,tt.forEach(s=>{[L.C,L.D,L.E,L.F,L.G,L.A,L.B].forEach(r=>{[J.flat,J.none,J.sharp].forEach(o=>{const c=new be(r,o,s,Q.topNote,t++);if(qt.includes(c.fullName))return;const h=new de(c,le.note);e[h.fullName]=h})})});for(const s in e){const l=e[s];n.addNote(l)}return n}const Pe={list:hn,setDefault:fn,subscribe:cn,set:Ht};function Mt(t,e,n){const s=t.slice();return s[6]=e[n],s}function St(t,e,n){const s=t.slice();return s[9]=e[n],s}function Gt(t){let e,n=t[9]+"",s,l,r;return{c(){e=v("option"),s=X(n),l=I(),this.h()},l(a){e=N(a,"OPTION",{class:!0});var o=b(e);s=W(o,n),l=P(o),o.forEach(f),this.h()},h(){e.__value=r=t[9],e.value=e.__value,y(e,"class","svelte-16amr53")},m(a,o){B(a,e,o),_(e,s),_(e,l)},p:te,d(a){a&&f(e)}}}function Lt(t){let e,n,s,l,r,a,o,c,h,i=t[1].notes,p=[];for(let d=0;d<i.length;d+=1)p[d]=zt(Mt(t,i,d));return{c(){e=v("div"),n=v("h3"),s=X("Note"),l=I(),r=v("div"),a=v("select");for(let d=0;d<p.length;d+=1)p[d].c();this.h()},l(d){e=N(d,"DIV",{class:!0});var g=b(e);n=N(g,"H3",{});var w=b(n);s=W(w,"Note"),w.forEach(f),l=P(g),r=N(g,"DIV",{class:!0});var A=b(r);a=N(A,"SELECT",{size:!0,class:!0});var C=b(a);for(let F=0;F<p.length;F+=1)p[F].l(C);C.forEach(f),A.forEach(f),g.forEach(f),this.h()},h(){y(a,"size",o=t[1].numberOfNotes),y(a,"class","svelte-16amr53"),t[0].note===void 0&&Ge(()=>t[5].call(a)),y(r,"class","track_select_container svelte-16amr53"),y(e,"class","track_inputs_container svelte-16amr53")},m(d,g){B(d,e,g),_(e,n),_(n,s),_(e,l),_(e,r),_(r,a);for(let w=0;w<p.length;w+=1)p[w].m(a,null);Ee(a,t[0].note),c||(h=[_e(a,"change",t[5]),_e(a,"change",t[3])],c=!0)},p(d,g){if(g&2){i=d[1].notes;let w;for(w=0;w<i.length;w+=1){const A=Mt(d,i,w);p[w]?p[w].p(A,g):(p[w]=zt(A),p[w].c(),p[w].m(a,null))}for(;w<p.length;w+=1)p[w].d(1);p.length=i.length}g&2&&o!==(o=d[1].numberOfNotes)&&y(a,"size",o),g&5&&Ee(a,d[0].note)},d(d){d&&f(e),Be(p,d),c=!1,pt(h)}}}function zt(t){let e,n=t[6].fullDetailedName+"",s,l,r;return{c(){e=v("option"),s=X(n),l=I(),this.h()},l(a){e=N(a,"OPTION",{class:!0});var o=b(e);s=W(o,n),l=P(o),o.forEach(f),this.h()},h(){e.__value=r=t[6],e.value=e.__value,y(e,"class","svelte-16amr53")},m(a,o){B(a,e,o),_(e,s),_(e,l)},p(a,o){o&2&&n!==(n=a[6].fullDetailedName+"")&&Le(s,n),o&2&&r!==(r=a[6])&&(e.__value=r,e.value=e.__value)},d(a){a&&f(e)}}}function _n(t){let e,n,s,l=t[0].fullName+"",r,a,o,c,h,i,p,d,g,w,A,C,F,he,H=t[2],j=[];for(let T=0;T<H.length;T+=1)j[T]=Gt(St(t,H,T));let z=t[0]&&t[1]&&t[0].isNote&&Lt(t);return{c(){e=v("div"),n=v("div"),s=v("div"),r=X(l),a=I(),o=v("div"),c=v("div"),h=v("h3"),i=X("Type"),p=I(),d=v("div"),g=v("select");for(let T=0;T<j.length;T+=1)j[T].c();w=I(),z&&z.c(),this.h()},l(T){e=N(T,"DIV",{class:!0,"data-track-note":!0});var q=b(e);n=N(q,"DIV",{class:!0});var V=b(n);s=N(V,"DIV",{class:!0});var K=b(s);r=W(K,l),K.forEach(f),a=P(V),o=N(V,"DIV",{class:!0});var M=b(o);c=N(M,"DIV",{class:!0});var S=b(c);h=N(S,"H3",{});var D=b(h);i=W(D,"Type"),D.forEach(f),p=P(S),d=N(S,"DIV",{class:!0});var ue=b(d);g=N(ue,"SELECT",{size:!0,class:!0});var E=b(g);for(let O=0;O<j.length;O+=1)j[O].l(E);E.forEach(f),ue.forEach(f),S.forEach(f),w=P(M),z&&z.l(M),M.forEach(f),V.forEach(f),q.forEach(f),this.h()},h(){y(s,"class","note-name svelte-16amr53"),y(g,"size",t[2].length),y(g,"class","svelte-16amr53"),t[0].type===void 0&&Ge(()=>t[4].call(g)),y(d,"class","track_select_container svelte-16amr53"),y(c,"class","track_inputs_container svelte-16amr53"),y(o,"class","track-note-menu svelte-16amr53"),y(n,"class",A="track-note type-"+t[0].type+" svelte-16amr53"),y(e,"class","track-note-container svelte-16amr53"),y(e,"data-track-note",C=t[0].fullName)},m(T,q){B(T,e,q),_(e,n),_(n,s),_(s,r),_(n,a),_(n,o),_(o,c),_(c,h),_(h,i),_(c,p),_(c,d),_(d,g);for(let V=0;V<j.length;V+=1)j[V].m(g,null);Ee(g,t[0].type),_(o,w),z&&z.m(o,null),F||(he=_e(g,"change",t[4]),F=!0)},p(T,[q]){if(q&1&&l!==(l=T[0].fullName+"")&&Le(r,l),q&4){H=T[2];let V;for(V=0;V<H.length;V+=1){const K=St(T,H,V);j[V]?j[V].p(K,q):(j[V]=Gt(K),j[V].c(),j[V].m(g,null))}for(;V<j.length;V+=1)j[V].d(1);j.length=H.length}q&5&&Ee(g,T[0].type),T[0]&&T[1]&&T[0].isNote?z?z.p(T,q):(z=Lt(T),z.c(),z.m(o,null)):z&&(z.d(1),z=null),q&5&&A!==(A="track-note type-"+T[0].type+" svelte-16amr53")&&y(n,"class",A),q&5&&C!==(C=T[0].fullName)&&y(e,"data-track-note",C)},i:te,o:te,d(T){T&&f(e),Be(j,T),z&&z.d(),F=!1,he()}}}function dn(t,e,n){let{trackNote:s}=e,l;const r=Object.values(le);Pe.subscribe(h=>{h&&s.refreshHtmlElement()}),Fe.subscribe(h=>{n(1,l=h)});function a(){ye.playNote(s)}Je(()=>s.refreshHtmlElement()),mt(()=>s.refreshHtmlElement());function o(){s.type=ze(this),n(0,s),n(2,r)}function c(){s.note=ze(this),n(0,s),n(2,r)}return t.$$set=h=>{"trackNote"in h&&n(0,s=h.trackNote)},[s,l,r,a,o,c]}class pn extends De{constructor(e){super();we(this,e,dn,_n,Ae,{trackNote:0})}}function mn(t){let e,n,s,l,r;return{c(){e=v("div"),n=v("div"),s=X("+"),this.h()},l(a){e=N(a,"DIV",{class:!0});var o=b(e);n=N(o,"DIV",{class:!0});var c=b(n);s=W(c,"+"),c.forEach(f),o.forEach(f),this.h()},h(){y(n,"class","track-note svelte-g8snzt"),y(e,"class","track-note-container svelte-g8snzt")},m(a,o){B(a,e,o),_(e,n),_(n,s),l||(r=_e(n,"click",t[0]),l=!0)},p:te,i:te,o:te,d(a){a&&f(e),l=!1,r()}}}function gn(t,e,n){let{position:s}=e,l;Pe.subscribe(a=>l=a||l);function r(){l.addNoteAt(s),Pe.set(l)}return t.$$set=a=>{"position"in a&&n(1,s=a.position)},[r,s]}class Ut extends De{constructor(e){super();we(this,e,gn,mn,Ae,{position:1})}}function Rt(t,e,n){const s=t.slice();return s[12]=e[n],s[13]=e,s[14]=n,s}function vn(t){let e,n,s,l;return{c(){e=v("button"),n=X("\u23EF"),this.h()},l(r){e=N(r,"BUTTON",{type:!0,class:!0});var a=b(e);n=W(a,"\u23EF"),a.forEach(f),this.h()},h(){y(e,"type","button"),y(e,"class","track-control svelte-zgc0o4")},m(r,a){B(r,e,a),_(e,n),s||(l=_e(e,"click",t[4]),s=!0)},p:te,d(r){r&&f(e),s=!1,l()}}}function Nn(t){let e,n,s,l;return{c(){e=v("button"),n=X("\u23F8"),this.h()},l(r){e=N(r,"BUTTON",{type:!0,class:!0});var a=b(e);n=W(a,"\u23F8"),a.forEach(f),this.h()},h(){y(e,"type","button"),y(e,"class","track-control svelte-zgc0o4")},m(r,a){B(r,e,a),_(e,n),s||(l=_e(e,"click",t[5]),s=!0)},p:te,d(r){r&&f(e),s=!1,l()}}}function Xt(t){let e,n,s,l,r;function a(c){t[9](c,t[12],t[13],t[14])}let o={};return t[12]!==void 0&&(o.trackNote=t[12]),e=new pn({props:o}),He.push(()=>Ve(e,"trackNote",a)),l=new Ut({props:{position:t[14]+1}}),{c(){ae(e.$$.fragment),s=I(),ae(l.$$.fragment)},l(c){ie(e.$$.fragment,c),s=P(c),ie(l.$$.fragment,c)},m(c,h){re(e,c,h),B(c,s,h),re(l,c,h),r=!0},p(c,h){t=c;const i={};!n&&h&4&&(n=!0,i.trackNote=t[12],Oe(()=>n=!1)),e.$set(i)},i(c){r||(Y(e.$$.fragment,c),Y(l.$$.fragment,c),r=!0)},o(c){x(e.$$.fragment,c),x(l.$$.fragment,c),r=!1},d(c){ce(e,c),c&&f(s),ce(l,c)}}}function bn(t){let e,n,s,l,r,a,o,c,h,i,p,d,g,w,A,C,F,he,H;function j(E){t[7](E)}let z={min:ke.MIN_BEAT,max:ke.MAX_BEAT,float:!0,pips:!0,all:"label",springValues:t[6]};t[1]!==void 0&&(z.values=t[1]),o=new vt({props:z}),He.push(()=>Ve(o,"values",j));function T(E){t[8](E)}let q={min:ke.MIN_BPM,max:ke.MAX_BPM,step:5,float:!0,pips:!0,pipstep:2,all:"label",springValues:t[6]};t[0]!==void 0&&(q.values=t[0]),d=new vt({props:q}),He.push(()=>Ve(d,"values",T));function V(E,O){return E[3]?Nn:vn}let K=V(t),M=K(t);F=new Ut({props:{position:1}});let S=t[2].notes,D=[];for(let E=0;E<S.length;E+=1)D[E]=Xt(Rt(t,S,E));const ue=E=>x(D[E],1,1,()=>{D[E]=null});return{c(){e=v("h2"),n=X("Track"),s=I(),l=v("section"),r=v("div"),a=X(`Beat:
		`),ae(o.$$.fragment),h=I(),i=v("div"),p=X(`Speed (bpm):
		`),ae(d.$$.fragment),w=I(),M.c(),A=I(),C=v("div"),ae(F.$$.fragment),he=I();for(let E=0;E<D.length;E+=1)D[E].c();this.h()},l(E){e=N(E,"H2",{});var O=b(e);n=W(O,"Track"),O.forEach(f),s=P(E),l=N(E,"SECTION",{class:!0});var Z=b(l);r=N(Z,"DIV",{});var ne=b(r);a=W(ne,`Beat:
		`),ie(o.$$.fragment,ne),ne.forEach(f),h=P(Z),i=N(Z,"DIV",{});var G=b(i);p=W(G,`Speed (bpm):
		`),ie(d.$$.fragment,G),G.forEach(f),w=P(Z),M.l(Z),A=P(Z),C=N(Z,"DIV",{class:!0});var oe=b(C);ie(F.$$.fragment,oe),he=P(oe);for(let pe=0;pe<D.length;pe+=1)D[pe].l(oe);oe.forEach(f),Z.forEach(f),this.h()},h(){y(C,"class","notes svelte-zgc0o4"),y(l,"class","svelte-zgc0o4")},m(E,O){B(E,e,O),_(e,n),B(E,s,O),B(E,l,O),_(l,r),_(r,a),re(o,r,null),_(l,h),_(l,i),_(i,p),re(d,i,null),_(l,w),M.m(l,null),_(l,A),_(l,C),re(F,C,null),_(C,he);for(let Z=0;Z<D.length;Z+=1)D[Z].m(C,null);H=!0},p(E,[O]){const Z={};!c&&O&2&&(c=!0,Z.values=E[1],Oe(()=>c=!1)),o.$set(Z);const ne={};if(!g&&O&1&&(g=!0,ne.values=E[0],Oe(()=>g=!1)),d.$set(ne),K===(K=V(E))&&M?M.p(E,O):(M.d(1),M=K(E),M&&(M.c(),M.m(l,A))),O&4){S=E[2].notes;let G;for(G=0;G<S.length;G+=1){const oe=Rt(E,S,G);D[G]?(D[G].p(oe,O),Y(D[G],1)):(D[G]=Xt(oe),D[G].c(),Y(D[G],1),D[G].m(C,null))}for(qe(),G=S.length;G<D.length;G+=1)ue(G);Ke()}},i(E){if(!H){Y(o.$$.fragment,E),Y(d.$$.fragment,E),Y(F.$$.fragment,E);for(let O=0;O<S.length;O+=1)Y(D[O]);H=!0}},o(E){x(o.$$.fragment,E),x(d.$$.fragment,E),x(F.$$.fragment,E),D=D.filter(Boolean);for(let O=0;O<D.length;O+=1)x(D[O]);H=!1},d(E){E&&f(e),E&&f(s),E&&f(l),ce(o),ce(d),M.d(),ce(F),Be(D,E)}}}function En(t,e,n){let s,l,r=[120],a=[4],o=!1;Pe.subscribe(A=>{n(2,l=A||l),n(0,r=[l.bpm]),n(1,a=[l.beat]),c()}),Fe.subscribe(A=>{s=A||s,c()});function c(){l&&s&&l.syncWithTune(s)}function h(){n(3,o=!0),ye.playTrack(l,()=>i())}function i(){n(3,o=!1),ye.stop()}const p={stiffness:.15,damping:.8};function d(A){a=A,n(1,a)}function g(A){r=A,n(0,r)}function w(A,C,F,he){F[he]=A,n(2,l),n(0,r),n(1,a)}return t.$$.update=()=>{t.$$.dirty&3&&(n(2,l.bpm=r[0],l),n(2,l.beat=a[0],l))},[r,a,l,o,h,i,p,d,g,w]}class yn extends De{constructor(e){super();we(this,e,En,bn,Ae,{})}}function Wt(t,e,n){const s=t.slice();return s[6]=e[n],s[8]=n,s}function Jt(t){let e,n=t[6].name+"",s,l,r;return{c(){e=v("option"),s=X(n),l=I(),this.h()},l(a){e=N(a,"OPTION",{});var o=b(e);s=W(o,n),l=P(o),o.forEach(f),this.h()},h(){e.__value=r=t[8],e.value=e.__value},m(a,o){B(a,e,o),_(e,s),_(e,l)},p(a,o){o&1&&n!==(n=a[6].name+"")&&Le(s,n)},d(a){a&&f(e)}}}function kn(t){let e,n,s,l,r,a,o=t[0],c=[];for(let h=0;h<o.length;h+=1)c[h]=Jt(Wt(t,o,h));return{c(){e=v("h2"),n=X("Track list"),s=I(),l=v("select");for(let h=0;h<c.length;h+=1)c[h].c();this.h()},l(h){e=N(h,"H2",{});var i=b(e);n=W(i,"Track list"),i.forEach(f),s=P(h),l=N(h,"SELECT",{name:!0,id:!0,class:!0});var p=b(l);for(let d=0;d<c.length;d+=1)c[d].l(p);p.forEach(f),this.h()},h(){y(l,"name","tracks_list"),y(l,"id","tracks_list"),y(l,"class","svelte-81oup7")},m(h,i){B(h,e,i),_(e,n),B(h,s,i),B(h,l,i);for(let p=0;p<c.length;p+=1)c[p].m(l,null);r||(a=_e(l,"change",t[1]),r=!0)},p(h,[i]){if(i&1){o=h[0];let p;for(p=0;p<o.length;p+=1){const d=Wt(h,o,p);c[p]?c[p].p(d,i):(c[p]=Jt(d),c[p].c(),c[p].m(l,null))}for(;p<c.length;p+=1)c[p].d(1);c.length=o.length}},i:te,o:te,d(h){h&&f(e),h&&f(s),h&&f(l),Be(c,h),r=!1,a()}}}function $n(t,e,n){let s,l,r,a=[];Fe.subscribe(h=>{s=h||s}),Pe.subscribe(h=>r=h||r);function o(h){var i;c(parseInt((i=h.target)===null||i===void 0?void 0:i.value,10))}function c(h){if(!a[h])throw"Invalid track index selected.";r=a[h],l.setItem("current_track",h.toString()),Pe.set(r),r.syncWithTune(s)}return Je(()=>{n(0,a=Pe.list(s)),l=window.localStorage;const h=parseInt(l.getItem("current_track"),10);isNaN(h)||c(h)}),[a,o]}class Tn extends De{constructor(e){super();we(this,e,$n,kn,Ae,{})}}function Dn(t){let e,n,s,l,r,a,o,c,h,i,p;return l=new Tn({}),o=new rn({}),i=new yn({}),{c(){e=v("div"),n=v("aside"),s=v("section"),ae(l.$$.fragment),r=I(),a=v("section"),ae(o.$$.fragment),c=I(),h=v("aside"),ae(i.$$.fragment),this.h()},l(d){e=N(d,"DIV",{class:!0});var g=b(e);n=N(g,"ASIDE",{});var w=b(n);s=N(w,"SECTION",{});var A=b(s);ie(l.$$.fragment,A),A.forEach(f),r=P(w),a=N(w,"SECTION",{});var C=b(a);ie(o.$$.fragment,C),C.forEach(f),w.forEach(f),c=P(g),h=N(g,"ASIDE",{id:!0,class:!0});var F=b(h);ie(i.$$.fragment,F),F.forEach(f),g.forEach(f),this.h()},h(){y(h,"id","track"),y(h,"class","svelte-1x7zd4i"),y(e,"class","container svelte-1x7zd4i")},m(d,g){B(d,e,g),_(e,n),_(n,s),re(l,s,null),_(n,r),_(n,a),re(o,a,null),_(e,c),_(e,h),re(i,h,null),p=!0},p:te,i(d){p||(Y(l.$$.fragment,d),Y(o.$$.fragment,d),Y(i.$$.fragment,d),p=!0)},o(d){x(l.$$.fragment,d),x(o.$$.fragment,d),x(i.$$.fragment,d),p=!1},d(d){d&&f(e),ce(l),ce(o),ce(i)}}}function wn(t){return Je(()=>{ye.loadAudioFiles()}),[]}class Pn extends De{constructor(e){super();we(this,e,wn,Dn,Ae,{})}}export{Pn as default};
